"use strict";(()=>{var e={};e.id=7890,e.ids=[7890],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27910:e=>{e.exports=require("stream")},28354:e=>{e.exports=require("util")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{e.exports=require("path")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},48657:(e,t,r)=>{r.r(t),r.d(t,{patchFetch:()=>b,routeModule:()=>h,serverHooks:()=>w,workAsyncStorage:()=>_,workUnitAsyncStorage:()=>v});var s={};r.r(s),r.d(s,{GET:()=>m,OPTIONS:()=>y,POST:()=>f});var a=r(96559),o=r(48088),i=r(37719),n=r(32190),l=r(66321),d=r(70818),u=r(31075),c=r(55511),p=r.n(c);let g="dynamic-content/careers/content.json",m=(0,l.ru)(async(e,t)=>{try{let{searchParams:t}=new URL(e.url),r={page:t.get("page")?parseInt(t.get("page")):1,limit:t.get("limit")?parseInt(t.get("limit")):20,sort:t.get("sort")||"posted_date",order:t.get("order")||"desc",search:t.get("search")||void 0,category:t.get("category")||void 0,department:t.get("department")||void 0,location:t.get("location")||void 0,level:t.get("level")||void 0,type:t.get("type")||void 0,status:t.get("status")||void 0,featured:t.get("featured")||void 0,urgent:t.get("urgent")||void 0,remote:t.get("remote")||void 0,hybrid:t.get("hybrid")||void 0},s=await d.Yy.readJSON(g,!0),a=s.job_postings||[],o=s.departments||[];if(r.search){let e=r.search.toLowerCase();a=a.filter(t=>t.title?.toLowerCase().includes(e)||t.short_description?.toLowerCase().includes(e)||t.full_description?.toLowerCase().includes(e)||t.department?.toLowerCase().includes(e)||t.location?.city?.toLowerCase().includes(e)||t.location?.region?.toLowerCase().includes(e)||t.tags?.some(t=>t.toLowerCase().includes(e))||t.requirements?.essential?.some(t=>t.toLowerCase().includes(e))||t.requirements?.preferred?.some(t=>t.toLowerCase().includes(e)))}if(r.category&&(a=a.filter(e=>e.category===r.category)),r.department&&(a=a.filter(e=>e.department===r.department)),r.location&&(a=a.filter(e=>e.location?.city?.toLowerCase().includes(r.location.toLowerCase())||e.location?.region?.toLowerCase().includes(r.location.toLowerCase()))),r.level&&(a=a.filter(e=>e.level===r.level)),r.type&&(a=a.filter(e=>e.type===r.type)),r.status&&(a=a.filter(e=>e.status===r.status)),void 0!==r.featured){let e="true"===r.featured;a=a.filter(t=>!!t.featured===e)}if(void 0!==r.urgent){let e="true"===r.urgent;a=a.filter(t=>!!t.urgent===e)}if(void 0!==r.remote){let e="true"===r.remote;a=a.filter(t=>!!t.location?.remote===e)}if(void 0!==r.hybrid){let e="true"===r.hybrid;a=a.filter(t=>!!t.location?.hybrid===e)}a.sort((e,t)=>{let s=e[r.sort],a=t[r.sort];if(("posted_date"===r.sort||"deadline"===r.sort)&&(s=new Date(s||0).getTime(),a=new Date(a||0).getTime()),"number"==typeof s&&"number"==typeof a)return"desc"===r.order?a-s:s-a;let o=String(s||"").localeCompare(String(a||""));return"desc"===r.order?-o:o});let i=a.length,l=Math.ceil(i/r.limit),u=(r.page-1)*r.limit,c=a.slice(u,u+r.limit).map(e=>{let t=o.find(t=>t.id===e.category);return{...e,department_info:t?{id:t.id,name:t.name,slug:t.slug,color:t.color,icon:t.icon,open_positions:t.open_positions}:null,days_until_deadline:e.deadline?Math.ceil((new Date(e.deadline).getTime()-new Date().getTime())/864e5):null,days_since_posted:e.posted_date?Math.floor((new Date().getTime()-new Date(e.posted_date).getTime())/864e5):null}}),p={total_jobs:i,by_status:{active:a.filter(e=>"active"===e.status).length,paused:a.filter(e=>"paused"===e.status).length,closed:a.filter(e=>"closed"===e.status).length,draft:a.filter(e=>"draft"===e.status).length},by_level:{junior:a.filter(e=>"junior"===e.level).length,mid:a.filter(e=>"mid"===e.level).length,senior:a.filter(e=>"senior"===e.level).length,director:a.filter(e=>"director"===e.level).length},by_type:{"full-time":a.filter(e=>"full-time"===e.type).length,"part-time":a.filter(e=>"part-time"===e.type).length,contract:a.filter(e=>"contract"===e.type).length,internship:a.filter(e=>"internship"===e.type).length},featured_count:a.filter(e=>e.featured).length,urgent_count:a.filter(e=>e.urgent).length,remote_count:a.filter(e=>e.location?.remote).length,hybrid_count:a.filter(e=>e.location?.hybrid).length};return n.NextResponse.json({success:!0,data:{jobs:c,pagination:{page:r.page,limit:r.limit,total:i,totalPages:l,hasNextPage:r.page<l,hasPrevPage:r.page>1},filters:{search:r.search,category:r.category,department:r.department,location:r.location,level:r.level,type:r.type,status:r.status,featured:r.featured,urgent:r.urgent,remote:r.remote,hybrid:r.hybrid,sort:r.sort,order:r.order},departments:o.map(e=>({id:e.id,name:e.name,slug:e.slug,open_positions:a.filter(t=>t.category===e.id&&"active"===t.status).length,total_positions:a.filter(t=>t.category===e.id).length})),stats:p}})}catch(e){return await u.vF.error("careers-api","Failed to list jobs",e,{userId:t.user.id}),n.NextResponse.json({success:!1,error:"INTERNAL_ERROR",message:"Failed to retrieve jobs."},{status:500})}},(0,l.PS)("careers","read")()),f=(0,l.ru)(async(e,t)=>{try{let{title:r,slug:s,category:a,department:o,location:i,type:l="full-time",level:c="mid",status:m="draft",experience_years:f,featured:y=!1,urgent:h=!1,posted_date:_,deadline:v,short_description:w,full_description:b,key_responsibilities:x=[],requirements:j={essential:[],preferred:[]},salary:A,application_process:S,questions:T=[],tags:C=[],hiring_manager:N,seo:I={},metadata:R={}}=await e.json();if(!r||!a||!o||!i||!w)return n.NextResponse.json({success:!1,error:"INVALID_INPUT",message:"Title, category, department, location and short_description are required."},{status:400});let L=await d.Yy.readJSON(g,!0),O=L.job_postings||[],P=L.departments||[];if(!P.find(e=>e.id===a))return n.NextResponse.json({success:!1,error:"INVALID_DEPARTMENT",message:"The specified department does not exist."},{status:400});let q=s||r.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");if(O.some(e=>e.slug===q))return n.NextResponse.json({success:!1,error:"SLUG_EXISTS",message:"A job with this slug already exists."},{status:409});let k={id:`job-${p().randomBytes(6).toString("hex")}`,title:r,slug:q,category:a,department:o,location:{city:i.city||"",region:i.region||"",country:i.country||"Per\xfa",remote:!!i.remote,hybrid:!!i.hybrid,address:i.address||""},type:l,level:c,status:m,experience_years:f||0,featured:!!y,urgent:!!h,posted_date:_||new Date().toISOString().split("T")[0],deadline:v||null,short_description:w,full_description:b||"",key_responsibilities:Array.isArray(x)?x:[],requirements:{essential:Array.isArray(j.essential)?j.essential:[],preferred:Array.isArray(j.preferred)?j.preferred:[]},salary:A||null,application_process:S||null,questions:Array.isArray(T)?T:[],tags:Array.isArray(C)?C:[],applicant_count:0,view_count:0,hiring_manager:N||null,seo:{meta_title:I.meta_title||`${r} | Carreras M\xe9trica DIP`,meta_description:I.meta_description||w,keywords:Array.isArray(I.keywords)?I.keywords:[]},metadata:{...R,created_at:new Date().toISOString(),created_by:t.user.id,updated_at:new Date().toISOString(),updated_by:t.user.id}};O.push(k);let D=P.findIndex(e=>e.id===a);-1!==D&&"active"===m&&(P[D].open_positions=(P[D].open_positions||0)+1);let E={...L,job_postings:O,departments:P,page_info:{...L.page_info,hero:{...L.page_info.hero,stats:{...L.page_info.hero.stats,total_positions:O.filter(e=>"active"===e.status).length}}},metadata:{...L.metadata,total_open_positions:O.filter(e=>"active"===e.status).length,last_updated:new Date().toISOString()}};return await d.Yy.writeJSON(g,E,{validate:!0,backup:!0}),await u.vF.audit({action:"create",resource:"career-job",resourceId:k.id,message:`Career job '${r}' created`,user:t.user.id,ip_address:e.headers.get("x-forwarded-for")||"unknown",metadata:{title:r,slug:q,category:a,department:o,level:c,type:l}}),n.NextResponse.json({success:!0,message:"Job created successfully.",data:{job:k}},{status:201})}catch(e){return await u.vF.error("careers-api","Failed to create job",e,{userId:t.user.id}),n.NextResponse.json({success:!1,error:"INTERNAL_ERROR",message:"Failed to create job."},{status:500})}},(0,l.PS)("careers","write")());async function y(){return new n.NextResponse(null,{status:200,headers:{Allow:"GET, POST, OPTIONS","Access-Control-Allow-Methods":"GET, POST, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization"}})}let h=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/admin/careers/jobs/route",pathname:"/api/admin/careers/jobs",filename:"route",bundlePath:"app/api/admin/careers/jobs/route"},resolvedPagePath:"/root/proyectos/freelos/metrica/src/app/api/admin/careers/jobs/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:_,workUnitAsyncStorage:v,serverHooks:w}=h;function b(){return(0,i.patchFetch)({workAsyncStorage:_,workUnitAsyncStorage:v})}},55511:e=>{e.exports=require("crypto")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79428:e=>{e.exports=require("buffer")},79748:e=>{e.exports=require("fs/promises")},94735:e=>{e.exports=require("events")}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4447,580,3205,4659,1220,6321,818],()=>r(48657));module.exports=s})();