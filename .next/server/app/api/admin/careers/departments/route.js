"use strict";(()=>{var e={};e.id=7527,e.ids=[7527],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27910:e=>{e.exports=require("stream")},28354:e=>{e.exports=require("util")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{e.exports=require("path")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{e.exports=require("crypto")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79428:e=>{e.exports=require("buffer")},79748:e=>{e.exports=require("fs/promises")},94134:(e,t,r)=>{r.r(t),r.d(t,{patchFetch:()=>S,routeModule:()=>w,serverHooks:()=>j,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>v});var s={};r.r(s),r.d(s,{GET:()=>f,OPTIONS:()=>y,POST:()=>h});var a=r(96559),o=r(48088),n=r(37719),i=r(32190),l=r(66321),d=r(79748),u=r.n(d),p=r(33873),c=r.n(p),m=r(55511),g=r.n(m);let _=c().join(process.cwd(),"public/json/dynamic-content/careers/content.json"),f=(0,l.ru)(async(e,t)=>{try{let{searchParams:t}=new URL(e.url),r="true"===t.get("include_stats"),s=t.get("search"),a=t.get("featured"),o=await u().readFile(_,"utf-8"),n=JSON.parse(o),l=n.departments||[],d=n.job_postings||[];if(s){let e=s.toLowerCase();l=l.filter(t=>t.name?.toLowerCase().includes(e)||t.description?.toLowerCase().includes(e)||t.detailed_description?.toLowerCase().includes(e)||t.required_skills?.some(t=>t.toLowerCase().includes(e))||t.positions?.some(t=>t.toLowerCase().includes(e)))}if(null!=a){let e="true"===a;l=l.filter(t=>!!t.featured===e)}let p=l.map(e=>{let t=d.filter(t=>t.category===e.id),s=t.filter(e=>"active"===e.status),a={...e,open_positions:s.length,total_jobs:t.length};if(r){let e=t.reduce((e,t)=>e+(t.applicant_count||0),0),r=t.reduce((e,t)=>e+(t.view_count||0),0);return{...a,stats:{total_applications:e,total_views:r,average_applications_per_job:t.length>0?Math.round(e/t.length):0,average_views_per_job:t.length>0?Math.round(r/t.length):0,jobs_by_level:{junior:t.filter(e=>"junior"===e.level).length,mid:t.filter(e=>"mid"===e.level).length,senior:t.filter(e=>"senior"===e.level).length,director:t.filter(e=>"director"===e.level).length},jobs_by_status:{active:t.filter(e=>"active"===e.status).length,paused:t.filter(e=>"paused"===e.status).length,closed:t.filter(e=>"closed"===e.status).length,draft:t.filter(e=>"draft"===e.status).length}},recent_jobs:s.sort((e,t)=>new Date(t.posted_date).getTime()-new Date(e.posted_date).getTime()).slice(0,3).map(e=>({id:e.id,title:e.title,slug:e.slug,level:e.level,type:e.type,posted_date:e.posted_date,applicant_count:e.applicant_count,featured:e.featured,urgent:e.urgent}))}}return a});return i.NextResponse.json({success:!0,data:{departments:p,summary:{total_departments:l.length,total_open_positions:l.reduce((e,t)=>e+(t.open_positions||0),0),featured_departments:l.filter(e=>e.featured).length,total_employees:l.reduce((e,t)=>e+(t.total_employees||0),0)}}})}catch(e){return console.error("careers-api","Failed to list departments",e),i.NextResponse.json({success:!1,error:"INTERNAL_ERROR",message:"Failed to retrieve departments."},{status:500})}},(0,l.PS)("careers","read")()),h=(0,l.ru)(async(e,t)=>{try{let{name:r,slug:s,description:a,detailed_description:o,icon:n="Briefcase",color:l="#6B7280",open_positions:d=0,total_employees:p=0,growth_rate:c,featured:m=!1,required_skills:f=[],career_path:h,typical_projects:y=[],positions:w=[]}=await e.json();if(!r||!a)return i.NextResponse.json({success:!1,error:"INVALID_INPUT",message:"Name and description are required."},{status:400});let x=await u().readFile(_,"utf-8"),v=JSON.parse(x),j=v.departments||[],S=s||r.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");if(j.some(e=>e.slug===S))return i.NextResponse.json({success:!1,error:"SLUG_EXISTS",message:"A department with this slug already exists."},{status:409});let N={id:`dept-${g().randomBytes(6).toString("hex")}`,name:r,slug:S,description:a,detailed_description:o||a,icon:n,color:l,open_positions:Number(d),total_employees:Number(p),growth_rate:c||"+0%",featured:!!m,required_skills:Array.isArray(f)?f:[],career_path:h||null,typical_projects:Array.isArray(y)?y:[],positions:Array.isArray(w)?w:[],created_at:new Date().toISOString(),created_by:t.user.id,updated_at:new Date().toISOString(),updated_by:t.user.id};j.push(N);let A={...v,departments:j,metadata:{...v.metadata,total_departments:j.length,last_updated:new Date().toISOString()}};return await u().writeFile(_,JSON.stringify(A,null,2),"utf-8"),console.log(`Career department '${r}' created by user ${t.user.id}`),i.NextResponse.json({success:!0,message:"Department created successfully.",data:{department:N}},{status:201})}catch(e){return console.error("careers-api","Failed to create department",e),i.NextResponse.json({success:!1,error:"INTERNAL_ERROR",message:"Failed to create department."},{status:500})}},(0,l.PS)("careers","write")());async function y(){return new i.NextResponse(null,{status:200,headers:{Allow:"GET, POST, OPTIONS","Access-Control-Allow-Methods":"GET, POST, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization"}})}let w=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/admin/careers/departments/route",pathname:"/api/admin/careers/departments",filename:"route",bundlePath:"app/api/admin/careers/departments/route"},resolvedPagePath:"/root/proyectos/freelos/metrica/src/app/api/admin/careers/departments/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:v,serverHooks:j}=w;function S(){return(0,n.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:v})}},94735:e=>{e.exports=require("events")}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4447,580,3205,1220,6321],()=>r(94134));module.exports=s})();