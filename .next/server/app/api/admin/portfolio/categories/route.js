"use strict";(()=>{var e={};e.id=4193,e.ids=[4193],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9493:(e,t,r)=>{r.r(t),r.d(t,{patchFetch:()=>N,routeModule:()=>y,serverHooks:()=>h,workAsyncStorage:()=>w,workUnitAsyncStorage:()=>S});var s={};r.r(s),r.d(s,{GET:()=>f,OPTIONS:()=>x,POST:()=>m});var o=r(96559),a=r(48088),i=r(37719),n=r(32190),u=r(66321),d=r(70818),c=r(31075),p=r(55511),l=r.n(p);let g="dynamic-content/portfolio/content.json",f=(0,u.ru)(async(e,t)=>{try{let{searchParams:t}=new URL(e.url),r=t.get("search"),s=t.get("sort")||"order",o=t.get("order")||"asc",a=t.get("featured"),i=(await d.Yy.readJSON(g,!0)).categories||[];if(r){let e=r.toLowerCase();i=i.filter(t=>t.name?.toLowerCase().includes(e)||t.slug?.toLowerCase().includes(e)||t.description?.toLowerCase().includes(e))}if(null!==a){let e="true"===a;i=i.filter(t=>!!t.featured===e)}return i.sort((e,t)=>{let r=e[s]||"",a=t[s]||"";if("number"==typeof r&&"number"==typeof a)return"desc"===o?a-r:r-a;let i=r.toString().localeCompare(a.toString());return"desc"===o?-i:i}),n.NextResponse.json({success:!0,data:{categories:i,total:i.length,filters:{search:r,sort:s,order:o,featured:a}}})}catch(e){return await c.vF.error("portfolio-api","Failed to list categories",e,{userId:t.user.id}),n.NextResponse.json({success:!1,error:"INTERNAL_ERROR",message:"Failed to retrieve categories."},{status:500})}},(0,u.PS)("portfolio","read")()),m=(0,u.ru)(async(e,t)=>{try{let{name:r,slug:s,description:o,icon:a,color:i,featured_image:u,featured:p,order:f}=await e.json();if(!r||!s)return n.NextResponse.json({success:!1,error:"INVALID_INPUT",message:"Name and slug are required."},{status:400});if(!/^[a-z0-9-]+$/.test(s))return n.NextResponse.json({success:!1,error:"INVALID_SLUG",message:"Slug must contain only lowercase letters, numbers, and hyphens."},{status:400});let m=await d.Yy.readJSON(g,!0),x=m.categories||[];if(x.some(e=>e.slug===s))return n.NextResponse.json({success:!1,error:"SLUG_EXISTS",message:"A category with this slug already exists."},{status:409});let y={id:`cat_${l().randomBytes(8).toString("hex")}`,name:r,slug:s,description:o||"",icon:a||"",color:i||"#E84E0F",featured_image:u||"",featured:!!p,order:void 0!==f?Number(f):x.length,projects_count:0,total_investment:"",total_area:"",created_at:new Date().toISOString(),created_by:t.user.id,updated_at:new Date().toISOString(),updated_by:t.user.id};x.push(y);let w={...m,categories:x,metadata:{...m.metadata,updated_at:new Date().toISOString(),updated_by:t.user.id}};return await d.Yy.writeJSON(g,w,{validate:!0,backup:!0}),await c.vF.audit({action:"create",resource:"portfolio-category",resourceId:y.id,message:`Portfolio category '${r}' created`,user:t.user.id,ip_address:e.headers.get("x-forwarded-for")||"unknown",metadata:{name:r,slug:s}}),n.NextResponse.json({success:!0,message:"Category created successfully.",data:{category:y}},{status:201})}catch(e){return await c.vF.error("portfolio-api","Failed to create category",e,{userId:t.user.id}),n.NextResponse.json({success:!1,error:"INTERNAL_ERROR",message:"Failed to create category."},{status:500})}},(0,u.PS)("portfolio","write")());async function x(){return new n.NextResponse(null,{status:200,headers:{Allow:"GET, POST, OPTIONS","Access-Control-Allow-Methods":"GET, POST, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization"}})}let y=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/admin/portfolio/categories/route",pathname:"/api/admin/portfolio/categories",filename:"route",bundlePath:"app/api/admin/portfolio/categories/route"},resolvedPagePath:"/root/proyectos/freelos/metrica/src/app/api/admin/portfolio/categories/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:w,workUnitAsyncStorage:S,serverHooks:h}=y;function N(){return(0,i.patchFetch)({workAsyncStorage:w,workUnitAsyncStorage:S})}},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27910:e=>{e.exports=require("stream")},28354:e=>{e.exports=require("util")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{e.exports=require("path")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{e.exports=require("crypto")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79428:e=>{e.exports=require("buffer")},79748:e=>{e.exports=require("fs/promises")},94735:e=>{e.exports=require("events")}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4447,580,3205,4659,1220,6321,818],()=>r(9493));module.exports=s})();