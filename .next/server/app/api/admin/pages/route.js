"use strict";(()=>{var e={};e.id=670,e.ids=[670],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27910:e=>{e.exports=require("stream")},28354:e=>{e.exports=require("util")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{e.exports=require("path")},34173:(e,t,r)=>{r.r(t),r.d(t,{patchFetch:()=>f,routeModule:()=>g,serverHooks:()=>w,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>x});var s={};r.r(s),r.d(s,{GET:()=>d,OPTIONS:()=>c});var a=r(96559),o=r(48088),i=r(37719),n=r(32190),p=r(66321),u=r(70818),l=r(31075);let d=(0,p.ru)(async(e,t)=>{try{let{searchParams:t}=new URL(e.url),r=t.get("search"),s=t.get("sort")||"name",a=t.get("order")||"asc",o=await u.Yy.fileManager.listFiles("pages"),i=[];for(let e of o)try{let t=await u.Yy.readJSON(`pages/${e}`,!0),s=e.replace(".json",""),a={slug:s,title:t.hero?.title||t.metadata?.title||s,description:t.hero?.subtitle||t.metadata?.description||"",last_modified:(await u.Yy.fileManager.getFileMetadata(`pages/${e}`)).lastModified,sections_count:Array.isArray(t.sections)?t.sections.length:0,status:t.metadata?.status||"active",featured_image:t.hero?.background_image||null};if(r){let e=r.toLowerCase();if(!(a.title.toLowerCase().includes(e)||a.description.toLowerCase().includes(e)||s.toLowerCase().includes(e)))continue}i.push(a)}catch(t){await l.vF.warn("pages-api",`Could not load page: ${e}`,{error:t.message})}return i.sort((e,t)=>{let r=e[s]||"",o=t[s]||"";return"desc"===a?o.toString().localeCompare(r.toString()):r.toString().localeCompare(o.toString())}),n.NextResponse.json({success:!0,data:{pages:i,total:i.length,filters:{search:r,sort:s,order:a}}})}catch(e){return await l.vF.error("pages-api","Failed to list pages",e,{userId:t.user.id}),n.NextResponse.json({success:!1,error:"INTERNAL_ERROR",message:"Failed to retrieve pages."},{status:500})}},(0,p.PS)("pages","read")());async function c(){return new n.NextResponse(null,{status:200,headers:{Allow:"GET, OPTIONS","Access-Control-Allow-Methods":"GET, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization"}})}let g=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/admin/pages/route",pathname:"/api/admin/pages",filename:"route",bundlePath:"app/api/admin/pages/route"},resolvedPagePath:"/root/proyectos/freelos/metrica/src/app/api/admin/pages/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:m,workUnitAsyncStorage:x,serverHooks:w}=g;function f(){return(0,i.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:x})}},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{e.exports=require("crypto")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79428:e=>{e.exports=require("buffer")},79748:e=>{e.exports=require("fs/promises")},94735:e=>{e.exports=require("events")}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4447,580,3205,4659,1220,6321,818],()=>r(34173));module.exports=s})();