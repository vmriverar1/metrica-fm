"use strict";(()=>{var e={};e.id=3922,e.ids=[3922],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27910:e=>{e.exports=require("stream")},28354:e=>{e.exports=require("util")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{e.exports=require("path")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},50884:(e,t,r)=>{r.r(t),r.d(t,{patchFetch:()=>S,routeModule:()=>_,serverHooks:()=>y,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>x});var a={};r.r(a),r.d(a,{GET:()=>m,OPTIONS:()=>w,POST:()=>g});var s=r(96559),i=r(48088),o=r(37719),u=r(32190),n=r(66321),d=r(70818),l=r(31075),c=r(55511),p=r.n(c);let h="dynamic-content/newsletter/content.json",m=(0,n.ru)(async(e,t)=>{try{let{searchParams:t}=new URL(e.url),r="true"===t.get("include_stats"),a=t.get("search"),s=t.get("featured"),i=await d.Yy.readJSON(h,!0),o=i.authors||[],n=i.articles||[];if(a){let e=a.toLowerCase();o=o.filter(t=>t.name?.toLowerCase().includes(e)||t.role?.toLowerCase().includes(e)||t.bio?.toLowerCase().includes(e)||t.specializations?.some(t=>t.toLowerCase().includes(e)))}if(null!=s){let e="true"===s;o=o.filter(t=>!!t.featured===e)}let l=o.map(e=>{let t=n.filter(t=>t.author_id===e.id),a=t.filter(e=>e.published_date),s={...e,articles_count:t.length,published_articles_count:a.length};if(r){let e=t.reduce((e,t)=>e+(t.reading_time||0),0);return{...s,stats:{total_reading_time:e,average_reading_time:t.length>0?Math.round(e/t.length):0,featured_articles:t.filter(e=>e.featured).length,draft_articles:t.filter(e=>!e.published_date).length,latest_article_date:a.length>0?a.sort((e,t)=>new Date(t.published_date).getTime()-new Date(e.published_date).getTime())[0].published_date:null},recent_articles:a.sort((e,t)=>new Date(t.published_date).getTime()-new Date(e.published_date).getTime()).slice(0,3).map(e=>({id:e.id,title:e.title,slug:e.slug,published_date:e.published_date,reading_time:e.reading_time,featured:e.featured}))}}return s});return u.NextResponse.json({success:!0,data:{authors:l,summary:{total_authors:o.length,featured_authors:o.filter(e=>e.featured).length,total_articles:o.reduce((e,t)=>e+(t.articles_count||0),0)}}})}catch(e){return await l.vF.error("newsletter-api","Failed to list authors",e,{userId:t.user.id}),u.NextResponse.json({success:!1,error:"INTERNAL_ERROR",message:"Failed to retrieve authors."},{status:500})}},(0,n.PS)("newsletter","read")()),g=(0,n.ru)(async(e,t)=>{try{let{name:r,role:a,bio:s,avatar:i,linkedin:o,email:n,featured:c=!1,specializations:m=[]}=await e.json();if(!r||!a||!s||!n)return u.NextResponse.json({success:!1,error:"INVALID_INPUT",message:"Name, role, bio and email are required."},{status:400});let g=await d.Yy.readJSON(h,!0),w=g.authors||[];if(w.some(e=>e.email===n))return u.NextResponse.json({success:!1,error:"EMAIL_EXISTS",message:"An author with this email already exists."},{status:409});let _={id:`author-${p().randomBytes(6).toString("hex")}`,name:r,role:a,bio:s,avatar:i||`https://i.pravatar.cc/400?u=${n}`,linkedin:o||"",email:n,featured:!!c,articles_count:0,specializations:Array.isArray(m)?m:[],created_at:new Date().toISOString(),created_by:t.user.id,updated_at:new Date().toISOString(),updated_by:t.user.id};w.push(_);let f={...g,authors:w,metadata:{...g.metadata,total_authors:w.length,featured_authors:w.filter(e=>e.featured).length,last_updated:new Date().toISOString()}};return await d.Yy.writeJSON(h,f,{validate:!0,backup:!0}),await l.vF.audit({action:"create",resource:"newsletter-author",resourceId:_.id,message:`Newsletter author '${r}' created`,user:t.user.id,ip_address:e.headers.get("x-forwarded-for")||"unknown",metadata:{name:r,role:a,email:n,featured:c}}),u.NextResponse.json({success:!0,message:"Author created successfully.",data:{author:_}},{status:201})}catch(e){return await l.vF.error("newsletter-api","Failed to create author",e,{userId:t.user.id}),u.NextResponse.json({success:!1,error:"INTERNAL_ERROR",message:"Failed to create author."},{status:500})}},(0,n.PS)("newsletter","write")());async function w(){return new u.NextResponse(null,{status:200,headers:{Allow:"GET, POST, OPTIONS","Access-Control-Allow-Methods":"GET, POST, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization"}})}let _=new s.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/admin/newsletter/authors/route",pathname:"/api/admin/newsletter/authors",filename:"route",bundlePath:"app/api/admin/newsletter/authors/route"},resolvedPagePath:"/root/proyectos/freelos/metrica/src/app/api/admin/newsletter/authors/route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:f,workUnitAsyncStorage:x,serverHooks:y}=_;function S(){return(0,o.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:x})}},55511:e=>{e.exports=require("crypto")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79428:e=>{e.exports=require("buffer")},79748:e=>{e.exports=require("fs/promises")},94735:e=>{e.exports=require("events")}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[4447,580,3205,4659,1220,6321,818],()=>r(50884));module.exports=a})();