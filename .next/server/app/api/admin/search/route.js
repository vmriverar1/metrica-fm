"use strict";(()=>{var e={};e.id=7842,e.ids=[7842],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27910:e=>{e.exports=require("stream")},28354:e=>{e.exports=require("util")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{e.exports=require("path")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{e.exports=require("crypto")},57683:(e,t,r)=>{r.r(t),r.d(t,{patchFetch:()=>m,routeModule:()=>h,serverHooks:()=>f,workAsyncStorage:()=>g,workUnitAsyncStorage:()=>y});var i={};r.r(i),r.d(i,{GET:()=>d,OPTIONS:()=>u});var o=r(96559),s=r(48088),a=r(37719),n=r(32190),l=r(66321),c=r(70818),p=r(31075);let d=(0,l.ru)(async(e,t)=>{try{let{searchParams:r}=new URL(e.url),i={q:r.get("q")||"",type:r.get("type")||"all",limit:r.get("limit")?parseInt(r.get("limit")):50,fuzzy:"true"===r.get("fuzzy")};if(!i.q||i.q.trim().length<2)return n.NextResponse.json({success:!1,error:"INVALID_QUERY",message:"Search query must be at least 2 characters long."},{status:400});let o=i.q.toLowerCase().trim(),s=[],a=(e,t,r=1)=>{if(!e)return 0;let s=e.toLowerCase(),a=0;s.includes(o)&&(a+=10*r);let n=o.split(" "),l=s.split(" ");return n.forEach(e=>{l.forEach(t=>{t.includes(e)&&e.length>2&&(a+=3*r)})}),i.fuzzy&&n.forEach(t=>{t.length>3&&RegExp(t.split("").join(".*"),"i").test(e)&&(a+=+r)}),a},l=(e,t)=>{let r=[];return t.forEach(t=>{let i=t.split(".").reduce((e,t)=>e?.[t],e);i&&"string"==typeof i&&a(i,t)>0&&r.push(t)}),r};if("all"===i.type||"pages"===i.type)try{for(let e of["pages/about-historia.json"])try{let t=await c.Yy.readJSON(e,!0);if(t.page_info){let r,i=t.page_info;(r=0+a(i.title,"title",3)+a(i.description,"description",2)+a(i.meta_description,"meta_description",1))>0&&s.push({id:e.replace(".json",""),type:"page",title:i.title||"P\xe1gina",description:i.description||i.meta_description||"",url:`/${e.replace("pages/","").replace(".json","")}`,score:r,metadata:{type:"static_page",file:e},highlighted_fields:l(i,["title","description","meta_description"])})}}catch(e){continue}}catch(e){}if("all"===i.type||"portfolio"===i.type)try{let e=await c.Yy.readJSON("dynamic-content/portfolio/content.json",!0);e.projects&&e.projects.forEach(e=>{let t;(t=0+a(e.title,"title",3)+a(e.description,"description",2)+a(e.location,"location",1)+a(e.client,"client",1)+a(e.tags?.join(" "),"tags",1))>0&&s.push({id:e.id,type:"portfolio-project",title:e.title,description:e.description||"",url:`/portfolio/${e.slug}`,score:t,metadata:{category:e.category,status:e.status,client:e.client,location:e.location},highlighted_fields:l(e,["title","description","location","client","tags"])})}),e.categories&&e.categories.forEach(e=>{let t;(t=0+a(e.name,"name",3)+a(e.description,"description",2))>0&&s.push({id:e.id,type:"portfolio-category",title:e.name,description:e.description||"",url:`/portfolio/category/${e.slug}`,score:t,metadata:{projects_count:e.projects_count,color:e.color},highlighted_fields:l(e,["name","description"])})})}catch(e){}if("all"===i.type||"careers"===i.type)try{let e=await c.Yy.readJSON("dynamic-content/careers/content.json",!0);e.job_postings&&e.job_postings.forEach(e=>{let t;(t=0+a(e.title,"title",3)+a(e.short_description,"short_description",2)+a(e.full_description,"full_description",1)+a(e.department,"department",2)+a(e.location?.city,"location.city",1)+a(e.requirements?.essential?.join(" "),"requirements.essential",1)+a(e.tags?.join(" "),"tags",1))>0&&s.push({id:e.id,type:"career-job",title:e.title,description:e.short_description||"",url:`/careers/job/${e.slug}`,score:t,metadata:{department:e.department,level:e.level,type:e.type,status:e.status,location:e.location,featured:e.featured,urgent:e.urgent},highlighted_fields:l(e,["title","short_description","department","location.city","tags"])})}),e.departments&&e.departments.forEach(e=>{let t;(t=0+a(e.name,"name",3)+a(e.description,"description",2)+a(e.detailed_description,"detailed_description",1)+a(e.required_skills?.join(" "),"required_skills",1))>0&&s.push({id:e.id,type:"career-department",title:e.name,description:e.description||"",url:`/careers/department/${e.slug}`,score:t,metadata:{open_positions:e.open_positions,total_employees:e.total_employees,featured:e.featured},highlighted_fields:l(e,["name","description","detailed_description","required_skills"])})})}catch(e){}if("all"===i.type||"newsletter"===i.type)try{let e=await c.Yy.readJSON("dynamic-content/newsletter/content.json",!0);e.articles&&e.articles.forEach(e=>{let t;(t=0+a(e.title,"title",3)+a(e.excerpt,"excerpt",2)+a(e.content,"content",1)+a(e.tags?.join(" "),"tags",1))>0&&s.push({id:e.id,type:"newsletter-article",title:e.title,description:e.excerpt||"",url:`/blog/${e.slug}`,score:t,metadata:{category:e.category,author_id:e.author_id,published_date:e.published_date,featured:e.featured,reading_time:e.reading_time},highlighted_fields:l(e,["title","excerpt","content","tags"])})}),e.authors&&e.authors.forEach(e=>{let t;(t=0+a(e.name,"name",3)+a(e.role,"role",2)+a(e.bio,"bio",1)+a(e.specializations?.join(" "),"specializations",1))>0&&s.push({id:e.id,type:"newsletter-author",title:e.name,description:`${e.role} - ${e.bio}`,url:`/blog/author/${e.id}`,score:t,metadata:{role:e.role,articles_count:e.articles_count,featured:e.featured,specializations:e.specializations},highlighted_fields:l(e,["name","role","bio","specializations"])})}),e.categories&&e.categories.forEach(e=>{let t;(t=0+a(e.name,"name",3)+a(e.description,"description",2))>0&&s.push({id:e.id,type:"newsletter-category",title:e.name,description:e.description||"",url:`/blog/category/${e.slug}`,score:t,metadata:{articles_count:e.articles_count,featured:e.featured,color:e.color},highlighted_fields:l(e,["name","description"])})})}catch(e){}let d=s.sort((e,t)=>t.score-e.score).slice(0,i.limit),u={total_results:d.length,search_term:i.q,search_type:i.type,fuzzy_enabled:i.fuzzy,by_type:{pages:d.filter(e=>"page"===e.type).length,"portfolio-projects":d.filter(e=>"portfolio-project"===e.type).length,"portfolio-categories":d.filter(e=>"portfolio-category"===e.type).length,"career-jobs":d.filter(e=>"career-job"===e.type).length,"career-departments":d.filter(e=>"career-department"===e.type).length,"newsletter-articles":d.filter(e=>"newsletter-article"===e.type).length,"newsletter-authors":d.filter(e=>"newsletter-author"===e.type).length,"newsletter-categories":d.filter(e=>"newsletter-category"===e.type).length},avg_score:d.length>0?Math.round(d.reduce((e,t)=>e+t.score,0)/d.length):0};return await p.vF.info("search-api",`Search performed: "${i.q}"`,{userId:t.user.id,searchTerm:i.q,searchType:i.type,resultsCount:d.length,fuzzyEnabled:i.fuzzy}),n.NextResponse.json({success:!0,data:{results:d,stats:u,query:{term:i.q,type:i.type,fuzzy:i.fuzzy,limit:i.limit}}})}catch(r){return await p.vF.error("search-api","Failed to perform search",r,{userId:t.user.id,searchQuery:e.url}),n.NextResponse.json({success:!1,error:"INTERNAL_ERROR",message:"Failed to perform search."},{status:500})}},(0,l.PS)("search","read")());async function u(){return new n.NextResponse(null,{status:200,headers:{Allow:"GET, OPTIONS","Access-Control-Allow-Methods":"GET, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization"}})}let h=new o.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/admin/search/route",pathname:"/api/admin/search",filename:"route",bundlePath:"app/api/admin/search/route"},resolvedPagePath:"/root/proyectos/freelos/metrica/src/app/api/admin/search/route.ts",nextConfigOutput:"",userland:i}),{workAsyncStorage:g,workUnitAsyncStorage:y,serverHooks:f}=h;function m(){return(0,a.patchFetch)({workAsyncStorage:g,workUnitAsyncStorage:y})}},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79428:e=>{e.exports=require("buffer")},79748:e=>{e.exports=require("fs/promises")},94735:e=>{e.exports=require("events")}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[4447,580,3205,4659,1220,6321,818],()=>r(57683));module.exports=i})();