(()=>{var e={};e.id=5083,e.ids=[5083],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19740:(e,t,r)=>{Promise.resolve().then(r.bind(r,28803))},22030:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c});var a=r(65239),s=r(48088),i=r(88170),o=r.n(i),n=r(30893),l={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);r.d(t,l);let c={children:["",{children:["admin",{children:["json-crud",{children:["newsletter",{children:["categories",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,35273)),"/root/proyectos/freelos/metrica/src/app/admin/json-crud/newsletter/categories/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,81217)),"/root/proyectos/freelos/metrica/src/app/admin/json-crud/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,99111)),"/root/proyectos/freelos/metrica/src/app/admin/layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"/root/proyectos/freelos/metrica/src/app/layout.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,67393)),"/root/proyectos/freelos/metrica/src/app/loading.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["/root/proyectos/freelos/metrica/src/app/admin/json-crud/newsletter/categories/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/admin/json-crud/newsletter/categories/page",pathname:"/admin/json-crud/newsletter/categories",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},28803:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var a=r(60687),s=r(43210),i=r(86401),o=r(44830),n=r(43034),l=r(29523),c=r(63503),d=r(91821),u=r(96834),m=r(20742),p=r(54052),x=r(88853),h=r(36644),g=r(8751);let f=()=>{let[e,t]=(0,s.useState)([]),[r,f]=(0,s.useState)(!0),[v,y]=(0,s.useState)(null),[b,w]=(0,s.useState)(!1),[j,N]=(0,s.useState)(null),[k,E]=(0,s.useState)(1),[C,_]=(0,s.useState)(""),[A,P]=(0,s.useState)("all"),S=async()=>{try{f(!0);let e=await i.Ay.get("/api/admin/newsletter/categories");t(e.categories||[])}catch(e){y(e instanceof Error?e.message:"Error desconocido")}finally{f(!1)}};(0,s.useEffect)(()=>{S()},[]);let $=e.filter(e=>{let t=e.name.toLowerCase().includes(C.toLowerCase())||e.description.toLowerCase().includes(C.toLowerCase()),r="all"===A||e.status===A;return t&&r}),q=$.slice((k-1)*10,10*k),T=[{key:"color",label:"",render:e=>(0,a.jsx)("div",{className:"w-4 h-4 rounded-full border border-gray-300",style:{backgroundColor:e.color}})},{key:"name",label:"Nombre",render:e=>(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"text-lg",children:e.icon}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.name}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["/",e.slug]})]})]})},{key:"description",label:"Descripci\xf3n",render:e=>(0,a.jsx)("div",{className:"max-w-xs truncate text-sm text-gray-600",children:e.description})},{key:"article_count",label:"Art\xedculos",render:e=>(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"font-medium",children:e.article_count}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[e.metadata.featured_articles," destacados"]})]})},{key:"metadata.total_views",label:"Vistas Totales",render:e=>(0,a.jsx)("div",{className:"text-right font-mono text-sm",children:e.metadata.total_views.toLocaleString()})},{key:"order",label:"Orden",render:e=>(0,a.jsx)(u.E,{variant:"outline",children:e.order})},{key:"status",label:"Estado",render:e=>(0,a.jsx)(u.E,{variant:"active"===e.status?"default":"secondary",children:"active"===e.status?"Activa":"Inactiva"})}],O=[{label:"Editar",onClick:e=>{N(e),w(!0)},variant:"default"},{label:"Ver Art\xedculos",onClick:e=>{window.open(`/admin/json-crud/newsletter/articles?category=${e.slug}`,"_blank")},variant:"outline"},{label:"Subir",onClick:async e=>{let t=Math.max(1,e.order-1);await z(e.id,t)},variant:"outline",disabled:e=>1===e.order},{label:"Bajar",onClick:async t=>{let r=Math.min(Math.max(...e.map(e=>e.order)),t.order+1);await z(t.id,r)},variant:"outline",disabled:t=>t.order===Math.max(...e.map(e=>e.order))},{label:e=>"active"===e.status?"Desactivar":"Activar",onClick:async e=>{try{await i.Ay.put(`/api/admin/newsletter/categories/${e.id}`,{...e,status:"active"===e.status?"inactive":"active"})}catch(e){y(e instanceof Error?e.message:"Error al actualizar")}},variant:"outline"},{label:"Eliminar",onClick:async e=>{if(confirm("\xbfEst\xe1s seguro de que quieres eliminar esta categor\xeda?"))try{await i.Ay.delete(`/api/admin/newsletter/categories/${e.id}`)}catch(e){y(e instanceof Error?e.message:"Error al eliminar")}},variant:"destructive",confirmMessage:"\xbfEst\xe1s seguro de que quieres eliminar esta categor\xeda? Esta acci\xf3n no se puede deshacer."}],z=async(t,r)=>{try{let a=e.find(e=>e.id===t);if(!a)return;await i.Ay.put(`/api/admin/newsletter/categories/${t}`,{...a,order:r})}catch(e){y(e instanceof Error?e.message:"Error al actualizar orden")}},I=async e=>{try{let t={name:e.name,slug:e.slug,description:e.description,color:e.color,icon:e.icon,order:parseInt(e.order),status:e.status,article_count:j?.article_count||0,metadata:j?.metadata||{total_views:0,avg_reading_time:0,featured_articles:0,last_article_date:""},seo:{meta_title:e["seo.meta_title"]||"",meta_description:e["seo.meta_description"]||"",keywords:e["seo.keywords"]||[]}},r=j?`/api/admin/newsletter/categories/${j.id}`:"/api/admin/newsletter/categories",a=j?"PUT":"POST",s=await fetch(r,{method:a,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok){let e=await s.json();throw Error(e.error||"Error al guardar categor\xeda")}w(!1),N(null),await S(),y(null)}catch(e){y(e instanceof Error?e.message:"Error al guardar")}};return r?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),(0,a.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})}):(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[v&&(0,a.jsx)(d.Fc,{variant:"destructive",children:(0,a.jsx)(d.TN,{children:v})}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(m.A,{className:"h-6 w-6 text-green-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Gesti\xf3n de Categor\xedas"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Administra las categor\xedas del newsletter"})]})]}),(0,a.jsxs)(l.$,{onClick:()=>{N(null),w(!0)},className:"flex items-center gap-2",children:[(0,a.jsx)(p.A,{className:"h-4 w-4"}),"Nueva Categor\xeda"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(m.A,{className:"h-5 w-5 text-green-600"}),(0,a.jsx)("span",{className:"text-sm font-medium text-green-800",children:"Total Categor\xedas"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold text-green-900",children:e.length})]}),(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(x.A,{className:"h-5 w-5 text-blue-600"}),(0,a.jsx)("span",{className:"text-sm font-medium text-blue-800",children:"Activas"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-900",children:e.filter(e=>"active"===e.status).length})]}),(0,a.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(h.A,{className:"h-5 w-5 text-purple-600"}),(0,a.jsx)("span",{className:"text-sm font-medium text-purple-800",children:"Total Art\xedculos"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold text-purple-900",children:e.reduce((e,t)=>e+t.article_count,0)})]}),(0,a.jsxs)("div",{className:"bg-orange-50 p-4 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(g.A,{className:"h-5 w-5 text-orange-600"}),(0,a.jsx)("span",{className:"text-sm font-medium text-orange-800",children:"Total Vistas"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-900",children:e.reduce((e,t)=>e+t.metadata.total_views,0).toLocaleString()})]})]}),(0,a.jsx)(o.A,{data:q,columns:T,actions:O,searchable:!0,searchTerm:C,onSearchChange:_,filters:[{key:"status",label:"Estado",options:[{value:"all",label:"Todas"},{value:"active",label:"Activas"},{value:"inactive",label:"Inactivas"}],value:A,onChange:P}],pagination:{current:k,total:Math.ceil($.length/10),pageSize:10},onPageChange:E}),(0,a.jsx)(c.lG,{open:b,onOpenChange:w,children:(0,a.jsxs)(c.Cf,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(c.c7,{children:(0,a.jsx)(c.L3,{children:j?"Editar Categor\xeda":"Nueva Categor\xeda"})}),(0,a.jsx)(n.A,{fields:[{key:"name",label:"Nombre de la Categor\xeda",type:"text",required:!0,validation:{min:2,max:50}},{key:"slug",label:"Slug (URL)",type:"text",required:!0,placeholder:"tecnologia-innovacion",validation:{pattern:"^[a-z0-9-]+$",custom:e=>/^[a-z0-9-]+$/.test(e)?null:"El slug solo puede contener letras min\xfasculas, n\xfameros y guiones"}},{key:"description",label:"Descripci\xf3n",type:"textarea",required:!0,validation:{max:200}},{key:"color",label:"Color de la Categor\xeda",type:"text",required:!0,placeholder:"#3B82F6",validation:{pattern:"^#[0-9A-Fa-f]{6}$",custom:e=>/^#[0-9A-Fa-f]{6}$/.test(e)?null:"Ingrese un color hexadecimal v\xe1lido (ej: #3B82F6)"}},{key:"icon",label:"Icono (Emoji)",type:"text",required:!0,placeholder:"\uD83D\uDE80",validation:{max:2}},{key:"order",label:"Orden de Visualizaci\xf3n",type:"number",required:!0,validation:{min:1,max:100}},{key:"seo.meta_title",label:"T\xedtulo SEO",type:"text",group:"SEO",validation:{max:60},placeholder:"T\xedtulo optimizado para motores de b\xfasqueda"},{key:"seo.meta_description",label:"Descripci\xf3n SEO",type:"textarea",group:"SEO",validation:{max:160},placeholder:"Descripci\xf3n optimizada para motores de b\xfasqueda"},{key:"seo.keywords",label:"Palabras Clave",type:"tags",group:"SEO",placeholder:"Escriba palabras clave y presione Enter"},{key:"status",label:"Estado",type:"select",required:!0,options:[{value:"active",label:"Activa"},{value:"inactive",label:"Inactiva"}]}],initialValues:(t=>t?{name:t.name,slug:t.slug,description:t.description,color:t.color,icon:t.icon,order:t.order,"seo.meta_title":t.seo.meta_title,"seo.meta_description":t.seo.meta_description,"seo.keywords":t.seo.keywords,status:t.status}:{order:e.length+1})(j),onSubmit:I,onCancel:()=>{w(!1),N(null)},submitLabel:j?"Actualizar Categor\xeda":"Crear Categor\xeda"})]})})]})}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},35273:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/root/proyectos/freelos/metrica/src/app/admin/json-crud/newsletter/categories/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/root/proyectos/freelos/metrica/src/app/admin/json-crud/newsletter/categories/page.tsx","default")},61596:(e,t,r)=>{Promise.resolve().then(r.bind(r,35273))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79551:e=>{"use strict";e.exports=require("url")},86401:(e,t,r)=>{"use strict";async function a(e,t){let r=e.headers.get("content-type");if(!r||!r.includes("application/json")){if(!await e.text())return null;throw Error(`Expected JSON response, got: ${r}`)}try{let t=await e.text();if(!t.trim())return null;return JSON.parse(t)}catch(e){throw Error(`Invalid JSON response from ${t}: ${e instanceof Error?e.message:"Unknown JSON parse error"}`)}}async function s(e,t={}){return fetch(e,{...t,headers:{"Content-Type":"application/json",...t.headers||{}}})}r.d(t,{Ay:()=>i});let i={get:async function(e){try{let t=await s(e);if(!t.ok){let e=await t.text();throw Error(`API Error (${t.status}): ${e}`)}return await a(t,e)}catch(t){if(t instanceof TypeError&&t.message.includes("fetch"))throw Error(`Network error: Failed to fetch from ${e}. Check your internet connection.`);throw t}},post:async function(e,t){try{let r=await s(e,{method:"POST",body:JSON.stringify(t)});if(!r.ok){let e=await r.text();throw Error(`API Error (${r.status}): ${e}`)}return await a(r,e)}catch(t){if(t instanceof TypeError&&t.message.includes("fetch"))throw Error(`Network error: Failed to post to ${e}. Check your internet connection.`);throw t}},put:async function(e,t){try{let r=await s(e,{method:"PUT",body:JSON.stringify(t)});if(!r.ok){let e=await r.text();throw Error(`API Error (${r.status}): ${e}`)}return await a(r,e)}catch(t){if(t instanceof TypeError&&t.message.includes("fetch"))throw Error(`Network error: Failed to update ${e}. Check your internet connection.`);throw t}},delete:async function(e){try{let t=await s(e,{method:"DELETE"});if(!t.ok){let e=await t.text();throw Error(`API Error (${t.status}): ${e}`)}if(204===t.status)return null;return await a(t,e)}catch(t){if(t instanceof TypeError&&t.message.includes("fetch"))throw Error(`Network error: Failed to delete from ${e}. Check your internet connection.`);throw t}},fetch:s}},88853:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(82614).A)("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]])},91821:(e,t,r)=>{"use strict";r.d(t,{Fc:()=>l,TN:()=>c});var a=r(60687),s=r(43210),i=r(24224),o=r(4780);let n=(0,i.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=s.forwardRef(({className:e,variant:t,...r},s)=>(0,a.jsx)("div",{ref:s,role:"alert",className:(0,o.cn)(n({variant:t}),e),...r}));l.displayName="Alert",s.forwardRef(({className:e,...t},r)=>(0,a.jsx)("h5",{ref:r,className:(0,o.cn)("mb-1 font-medium leading-none tracking-tight",e),...t})).displayName="AlertTitle";let c=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)("div",{ref:r,className:(0,o.cn)("text-sm [&_p]:leading-relaxed",e),...t}));c.displayName="AlertDescription"}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[4447,4354,1658,5814,1141,7903,1801,3794,263,601,5125,212,5683],()=>r(22030));module.exports=a})();