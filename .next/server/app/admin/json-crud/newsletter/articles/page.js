(()=>{var e={};e.id=3868,e.ids=[3868],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3686:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});let r=(0,a(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/root/proyectos/freelos/metrica/src/app/admin/json-crud/newsletter/articles/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/root/proyectos/freelos/metrica/src/app/admin/json-crud/newsletter/articles/page.tsx","default")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},37875:(e,t,a)=>{Promise.resolve().then(a.bind(a,3686))},50832:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>j});var r=a(60687),s=a(43210),l=a(86401),o=a(16189),i=a(36644),n=a(916),c=a(58595),d=a(15036),u=a(26622),p=a(20742),m=a(76311),h=a(60368),x=a(35137),g=a(57207),y=a(54052),b=a(37408),f=a(14975),w=a(44830),v=a(43034);function j(){let[e,t]=(0,s.useState)([]),[a,j]=(0,s.useState)([]),[N,k]=(0,s.useState)([]),[E,A]=(0,s.useState)(!0),[_,P]=(0,s.useState)({page:1,limit:20,total:0,totalPages:0,hasNextPage:!1,hasPrevPage:!1}),[S,C]=(0,s.useState)({}),[q,$]=(0,s.useState)(""),[T,I]=(0,s.useState)("published_date"),[D,O]=(0,s.useState)("desc"),[R,L]=(0,s.useState)(!1),[M,G]=(0,s.useState)(null),[J,z]=(0,s.useState)(null);(0,o.useSearchParams)();let F=async()=>{A(!0);try{let e=new URLSearchParams({page:_.page.toString(),limit:_.limit.toString(),sort:T,order:D,...q&&{search:q},...S}),a=await l.Ay.get(`/api/admin/newsletter/articles?${e}`);a.success?(t(a.data.articles),j(a.data.authors),k(a.data.categories),P(a.data.pagination)):console.error("Error fetching articles:",a.message)}catch(e){console.error("Error fetching articles:",e)}finally{A(!1)}},U=()=>{G(null),L(!0)},B=async e=>{try{let t=await l.Ay.delete(`/api/admin/newsletter/articles/${e.id}`);t.success?(F(),z(null)):console.error("Error deleting article:",t.message)}catch(e){console.error("Error deleting article:",e)}},V=async e=>{try{let t=M?`/api/admin/newsletter/articles/${M.id}`:"/api/admin/newsletter/articles",a=M?"PUT":"POST",r=await fetch(t,{method:a,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await r.json();if(s.success)F(),L(!1),G(null);else throw Error(s.message||"Error saving article")}catch(e){throw console.error("Error saving article:",e),e}},H=[{key:"featured_image",label:"Imagen",width:"w-20",render:e=>(0,r.jsx)("div",{className:"w-12 h-12 rounded-lg bg-gray-200 overflow-hidden",children:e?(0,r.jsx)("img",{src:e,alt:"",className:"w-full h-full object-cover"}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,r.jsx)(i.A,{className:"w-6 h-6 text-gray-400"})})})},{key:"title",label:"T\xedtulo",sortable:!0,render:(e,t)=>(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"font-medium text-gray-900",children:e}),t.featured&&(0,r.jsx)(n.A,{className:"w-4 h-4 text-yellow-500"})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["/",t.slug]}),(0,r.jsxs)("div",{className:"text-xs text-gray-400 mt-1",children:[t.excerpt?.substring(0,60),"..."]})]})},{key:"author_info",label:"Autor",render:e=>e?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-200 overflow-hidden mr-3",children:e.avatar?(0,r.jsx)("img",{src:e.avatar,alt:e.name,className:"w-full h-full object-cover"}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,r.jsx)(c.A,{className:"w-4 h-4 text-gray-400"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:e.role})]})]}):null},{key:"category_info",label:"Categor\xeda",render:e=>e?(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full",style:{backgroundColor:`${e.color}20`,color:e.color},children:e.name}):null},{key:"status",label:"Estado",render:(e,t)=>(0,r.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${"published"===e?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:"published"===e?"Publicado":"Borrador"})},{key:"reading_time",label:"Lectura",render:e=>(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(d.A,{className:"w-4 h-4 text-gray-400 mr-2"}),(0,r.jsxs)("span",{className:"text-sm",children:[e||0," min"]})]})},{key:"published_date",label:"Publicaci\xf3n",sortable:!0,render:(e,t)=>e?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(u.A,{className:"w-4 h-4 text-gray-400 mr-2"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm",children:new Date(e).toLocaleDateString()}),void 0!==t.days_since_published&&(0,r.jsx)("div",{className:"text-xs text-gray-500",children:0===t.days_since_published?"Hoy":1===t.days_since_published?"Ayer":`Hace ${t.days_since_published} d\xedas`})]})]}):(0,r.jsx)("span",{className:"text-gray-400",children:"Sin publicar"})},{key:"tags",label:"Etiquetas",render:e=>(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e?.slice(0,2).map((e,t)=>(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[(0,r.jsx)(p.A,{className:"w-3 h-3 mr-1"}),e]},t)),e?.length>2&&(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["+",e.length-2]})]})}],K=[{label:"Ver",icon:m.A,onClick:e=>window.open(`/blog/${e.slug}`,"_blank"),variant:"secondary",show:e=>!!e.published_date},{label:"Vista previa",icon:h.A,onClick:e=>window.open(`/admin/preview/article/${e.id}`,"_blank"),variant:"secondary",show:e=>!e.published_date},{label:"Editar",icon:x.A,onClick:e=>{G(e),L(!0)},variant:"primary"},{label:"Eliminar",icon:g.A,onClick:e=>z(e),variant:"danger"}],X=[{key:"category",label:"Categor\xeda",type:"select",options:N.map(e=>({value:e.id,label:e.name}))},{key:"author_id",label:"Autor",type:"select",options:a.map(e=>({value:e.id,label:e.name}))},{key:"featured",label:"Destacado",type:"select",options:[{value:"true",label:"S\xed"},{value:"false",label:"No"}]},{key:"published",label:"Estado de publicaci\xf3n",type:"select",options:[{value:"true",label:"Publicado"},{value:"false",label:"Borrador"}]}],Q=[{key:"title",label:"T\xedtulo del Art\xedculo",type:"text",required:!0,placeholder:"T\xedtulo del art\xedculo...",group:"basic"},{key:"slug",label:"Slug",type:"text",placeholder:"Se genera autom\xe1ticamente si se deja vac\xedo",description:"URL amigable para el art\xedculo",group:"basic"},{key:"category",label:"Categor\xeda",type:"select",required:!0,options:N.map(e=>({value:e.id,label:e.name})),group:"basic"},{key:"author_id",label:"Autor",type:"select",required:!0,options:a.map(e=>({value:e.id,label:e.name})),group:"basic"},{key:"featured",label:"Art\xedculo Destacado",type:"checkbox",description:"Los art\xedculos destacados aparecen en posiciones prominentes",group:"basic"},{key:"excerpt",label:"Extracto",type:"textarea",required:!0,placeholder:"Resumen del art\xedculo que aparecer\xe1 en listados...",description:"Resumen breve del art\xedculo (m\xe1ximo 160 caracteres recomendado)",validation:{max:200},group:"content"},{key:"content",label:"Contenido",type:"markdown",required:!0,placeholder:"Escribe el contenido del art\xedculo en Markdown...",description:"Contenido completo del art\xedculo en formato Markdown",group:"content"},{key:"featured_image",label:"Imagen Principal",type:"url",placeholder:"https://ejemplo.com/imagen.jpg",description:"URL de la imagen principal del art\xedculo",group:"media"},{key:"featured_image_alt",label:"Texto Alternativo de la Imagen",type:"text",placeholder:"Descripci\xf3n de la imagen...",description:"Texto alternativo para accesibilidad",group:"media"},{key:"social_image",label:"Imagen para Redes Sociales",type:"url",placeholder:"https://ejemplo.com/imagen-social.jpg",description:"Imagen que aparecer\xe1 al compartir en redes sociales",group:"media"},{key:"published_date",label:"Fecha de Publicaci\xf3n",type:"datetime-local",description:"Deja vac\xedo para guardar como borrador",group:"publishing"},{key:"reading_time",label:"Tiempo de Lectura (minutos)",type:"number",placeholder:"0",description:"Se calcula autom\xe1ticamente si se deja vac\xedo",validation:{min:0,max:60},group:"publishing"},{key:"tags",label:"Etiquetas",type:"tags",placeholder:"Separar con comas...",description:"Etiquetas para categorizaci\xf3n y b\xfasqueda",group:"meta"},{key:"seo_description",label:"Meta Descripci\xf3n (SEO)",type:"textarea",placeholder:"Descripci\xf3n para motores de b\xfasqueda...",description:"Descripci\xf3n que aparecer\xe1 en los resultados de b\xfasqueda (m\xe1ximo 160 caracteres)",validation:{max:160},group:"meta"},{key:"related_articles",label:"Art\xedculos Relacionados",type:"tags",placeholder:"IDs de art\xedculos separados por comas...",description:"IDs de otros art\xedculos relacionados",group:"meta"}];return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Gesti\xf3n de Art\xedculos"}),(0,r.jsx)("p",{className:"mt-2 text-gray-600",children:"Administra todos los art\xedculos del blog y newsletter de la empresa."})]}),(0,r.jsx)(w.A,{data:e,columns:H,actions:K,filters:X,loading:E,pagination:_,onPageChange:e=>P(t=>({...t,page:e})),onLimitChange:e=>P(t=>({...t,limit:e,page:1})),onSortChange:(e,t)=>{I(e),O(t)},onFilterChange:C,onSearch:$,searchPlaceholder:"Buscar art\xedculos...",title:"Art\xedculos del Newsletter",subtitle:`${_.total} art\xedculos en total`,primaryAction:{label:"Nuevo Art\xedculo",onClick:U,icon:y.A},emptyState:(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(b.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No hay art\xedculos"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Comienza creando tu primer art\xedculo del newsletter."}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsxs)("button",{onClick:U,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[(0,r.jsx)(y.A,{className:"w-4 h-4 mr-2"}),"Nuevo Art\xedculo"]})})]})}),R&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,r.jsx)("div",{className:"relative top-10 mx-auto p-5 border w-11/12 max-w-5xl shadow-lg rounded-md bg-white",children:(0,r.jsx)("div",{className:"max-h-screen overflow-y-auto",children:(0,r.jsx)(v.A,{fields:Q,groups:[{name:"basic",label:"Informaci\xf3n B\xe1sica",description:"Datos fundamentales del art\xedculo"},{name:"content",label:"Contenido",description:"Extracto y contenido principal del art\xedculo"},{name:"media",label:"Medios",description:"Im\xe1genes y recursos visuales"},{name:"publishing",label:"Publicaci\xf3n",description:"Configuraci\xf3n de publicaci\xf3n y fechas"},{name:"meta",label:"Metadatos",description:"SEO y configuraci\xf3n adicional",collapsible:!0,defaultExpanded:!1}],initialValues:M||{},onSubmit:V,onCancel:()=>{L(!1),G(null)},title:M?"Editar Art\xedculo":"Nuevo Art\xedculo",subtitle:M?"Modifica los datos del art\xedculo":"Crea un nuevo art\xedculo para el newsletter",mode:M?"edit":"create"})})})}),J&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,r.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)(f.A,{className:"w-6 h-6 text-red-600 mr-3"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Confirmar Eliminaci\xf3n"})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mb-6",children:['\xbfEst\xe1s seguro de que deseas eliminar el art\xedculo "',(0,r.jsx)("strong",{children:J.title}),'"? Esta acci\xf3n no se puede deshacer.']}),(0,r.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,r.jsx)("button",{onClick:()=>z(null),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md",children:"Cancelar"}),(0,r.jsx)("button",{onClick:()=>B(J),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md",children:"Eliminar"})]})]})})})]})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74827:(e,t,a)=>{Promise.resolve().then(a.bind(a,50832))},79551:e=>{"use strict";e.exports=require("url")},81281:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c});var r=a(65239),s=a(48088),l=a(88170),o=a.n(l),i=a(30893),n={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>i[e]);a.d(t,n);let c={children:["",{children:["admin",{children:["json-crud",{children:["newsletter",{children:["articles",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,3686)),"/root/proyectos/freelos/metrica/src/app/admin/json-crud/newsletter/articles/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,81217)),"/root/proyectos/freelos/metrica/src/app/admin/json-crud/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,99111)),"/root/proyectos/freelos/metrica/src/app/admin/layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,94431)),"/root/proyectos/freelos/metrica/src/app/layout.tsx"],loading:[()=>Promise.resolve().then(a.bind(a,67393)),"/root/proyectos/freelos/metrica/src/app/loading.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["/root/proyectos/freelos/metrica/src/app/admin/json-crud/newsletter/articles/page.tsx"],u={require:a,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/admin/json-crud/newsletter/articles/page",pathname:"/admin/json-crud/newsletter/articles",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},86401:(e,t,a)=>{"use strict";async function r(e,t){let a=e.headers.get("content-type");if(!a||!a.includes("application/json")){if(!await e.text())return null;throw Error(`Expected JSON response, got: ${a}`)}try{let t=await e.text();if(!t.trim())return null;return JSON.parse(t)}catch(e){throw Error(`Invalid JSON response from ${t}: ${e instanceof Error?e.message:"Unknown JSON parse error"}`)}}async function s(e,t={}){return fetch(e,{...t,headers:{"Content-Type":"application/json",...t.headers||{}}})}a.d(t,{Ay:()=>l});let l={get:async function(e){try{let t=await s(e);if(!t.ok){let e=await t.text();throw Error(`API Error (${t.status}): ${e}`)}return await r(t,e)}catch(t){if(t instanceof TypeError&&t.message.includes("fetch"))throw Error(`Network error: Failed to fetch from ${e}. Check your internet connection.`);throw t}},post:async function(e,t){try{let a=await s(e,{method:"POST",body:JSON.stringify(t)});if(!a.ok){let e=await a.text();throw Error(`API Error (${a.status}): ${e}`)}return await r(a,e)}catch(t){if(t instanceof TypeError&&t.message.includes("fetch"))throw Error(`Network error: Failed to post to ${e}. Check your internet connection.`);throw t}},put:async function(e,t){try{let a=await s(e,{method:"PUT",body:JSON.stringify(t)});if(!a.ok){let e=await a.text();throw Error(`API Error (${a.status}): ${e}`)}return await r(a,e)}catch(t){if(t instanceof TypeError&&t.message.includes("fetch"))throw Error(`Network error: Failed to update ${e}. Check your internet connection.`);throw t}},delete:async function(e){try{let t=await s(e,{method:"DELETE"});if(!t.ok){let e=await t.text();throw Error(`API Error (${t.status}): ${e}`)}if(204===t.status)return null;return await r(t,e)}catch(t){if(t instanceof TypeError&&t.message.includes("fetch"))throw Error(`Network error: Failed to delete from ${e}. Check your internet connection.`);throw t}},fetch:s}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[4447,4354,1658,5814,1141,7903,1801,3794,263,601,5125,212,5683],()=>a(81281));module.exports=r})();