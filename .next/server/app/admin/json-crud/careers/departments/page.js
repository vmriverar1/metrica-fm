(()=>{var e={};e.id=4756,e.ids=[4756],e.modules={262:(e,a,t)=>{"use strict";t.r(a),t.d(a,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var r=t(65239),s=t(48088),i=t(88170),n=t.n(i),o=t(30893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);t.d(a,l);let d={children:["",{children:["admin",{children:["json-crud",{children:["careers",{children:["departments",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,8138)),"/root/proyectos/freelos/metrica/src/app/admin/json-crud/careers/departments/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,81217)),"/root/proyectos/freelos/metrica/src/app/admin/json-crud/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,99111)),"/root/proyectos/freelos/metrica/src/app/admin/layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,94431)),"/root/proyectos/freelos/metrica/src/app/layout.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,67393)),"/root/proyectos/freelos/metrica/src/app/loading.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/root/proyectos/freelos/metrica/src/app/admin/json-crud/careers/departments/page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/admin/json-crud/careers/departments/page",pathname:"/admin/json-crud/careers/departments",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},8138:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>r});let r=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/root/proyectos/freelos/metrica/src/app/admin/json-crud/careers/departments/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/root/proyectos/freelos/metrica/src/app/admin/json-crud/careers/departments/page.tsx","default")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},16308:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>f});var r=t(60687),s=t(43210),i=t(86401),n=t(44830),o=t(43034),l=t(29523),d=t(63503),c=t(91821),u=t(96834),m=t(22423),p=t(54052),h=t(48206),x=t(33886),g=t(8751);let f=()=>{let[e,a]=(0,s.useState)([]),[t,f]=(0,s.useState)(!0),[v,b]=(0,s.useState)(null),[y,j]=(0,s.useState)(!1),[w,_]=(0,s.useState)(null),[N,k]=(0,s.useState)(1),[E,q]=(0,s.useState)(""),[P,A]=(0,s.useState)("all"),[S,C]=(0,s.useState)("all"),T=async()=>{try{f(!0);let e=await i.Ay.get("/api/admin/careers/departments");a(e.data?.departments||[])}catch(e){b(e instanceof Error?e.message:"Error desconocido")}finally{f(!1)}};(0,s.useEffect)(()=>{T()},[]);let $=e.filter(e=>{let a=e.name.toLowerCase().includes(E.toLowerCase())||e.description.toLowerCase().includes(E.toLowerCase())||e.head.toLowerCase().includes(E.toLowerCase()),t="all"===P||e.status===P,r="all"===S||e.location===S;return a&&t&&r}),z=$.slice((N-1)*10,10*N),D=[{key:"name",label:"Departamento",render:e=>(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium",children:e.name}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:e.location})]})},{key:"head",label:"Jefe de \xc1rea",render:e=>(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("img",{src:e.head_avatar||"/default-avatar.png",alt:e.head,className:"w-8 h-8 rounded-full object-cover"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-sm",children:e.head}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:e.head_email})]})]})},{key:"team_size",label:"Equipo",render:e=>(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"font-medium",children:e.team_size}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"personas"})]})},{key:"open_positions",label:"Vacantes",render:e=>(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)(u.E,{variant:e.open_positions>0?"default":"secondary",children:e.open_positions})})},{key:"working_model",label:"Modalidad",render:e=>(0,r.jsx)(u.E,{className:{remote:"bg-green-100 text-green-800",hybrid:"bg-blue-100 text-blue-800",onsite:"bg-orange-100 text-orange-800"}[e.working_model],children:{remote:"Remoto",hybrid:"H\xedbrido",onsite:"Presencial"}[e.working_model]})},{key:"metadata.employee_satisfaction",label:"Satisfacci\xf3n",render:e=>(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("div",{className:"font-medium",children:[e.metadata.employee_satisfaction,"%"]}),(0,r.jsx)("div",{className:"w-12 bg-gray-200 rounded-full h-2 mx-auto",children:(0,r.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${e.metadata.employee_satisfaction}%`}})})]})},{key:"status",label:"Estado",render:e=>(0,r.jsx)(u.E,{variant:"active"===e.status?"default":"secondary",children:"active"===e.status?"Activo":"Inactivo"})}],L=[{label:"Editar",onClick:e=>{_(e),j(!0)},variant:"default"},{label:"Ver Empleos",onClick:e=>{window.open(`/admin/json-crud/careers/jobs?department=${e.slug}`,"_blank")},variant:"outline"},{label:e=>"active"===e.status?"Desactivar":"Activar",onClick:async e=>{try{await i.Ay.put(`/api/admin/careers/departments/${e.id}`,{...e,status:"active"===e.status?"inactive":"active"}),await T()}catch(e){b(e instanceof Error?e.message:"Error al actualizar")}},variant:"outline"},{label:"Eliminar",onClick:async e=>{if(confirm("\xbfEst\xe1s seguro de que quieres eliminar este departamento?"))try{await i.Ay.delete(`/api/admin/careers/departments/${e.id}`),await T()}catch(e){b(e instanceof Error?e.message:"Error al eliminar")}},variant:"destructive",confirmMessage:"\xbfEst\xe1s seguro de que quieres eliminar este departamento? Esta acci\xf3n no se puede deshacer."}],F=[{key:"status",label:"Estado",options:[{value:"all",label:"Todos"},{value:"active",label:"Activos"},{value:"inactive",label:"Inactivos"}],value:P,onChange:A},{key:"location",label:"Ubicaci\xf3n",options:[{value:"all",label:"Todas"},...[...new Set(e.map(e=>e.location))].map(e=>({value:e,label:e}))],value:S,onChange:C}],I=async e=>{try{let a={name:e.name,slug:e.slug,description:e.description,head:e.head,head_email:e.head_email,head_avatar:e.head_avatar||"",location:e.location,team_size:parseInt(e.team_size),open_positions:parseInt(e.open_positions),status:e.status,budget:{annual:parseFloat(e["budget.annual"]),allocated:parseFloat(e["budget.allocated"]),remaining:parseFloat(e["budget.annual"])-parseFloat(e["budget.allocated"])},metadata:{founded_date:w?.metadata.founded_date||new Date().toISOString(),total_hires:w?.metadata.total_hires||0,avg_salary:parseFloat(e["metadata.avg_salary"]),employee_satisfaction:parseInt(e["metadata.employee_satisfaction"]),turnover_rate:parseFloat(e["metadata.turnover_rate"])},skills_required:e.skills_required||[],benefits:e.benefits||[],working_model:e.working_model},t=w?`/api/admin/careers/departments/${w.id}`:"/api/admin/careers/departments",r=w?"PUT":"POST",s=await fetch(t,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!s.ok){let e=await s.json();throw Error(e.error||"Error al guardar departamento")}j(!1),_(null),await T(),b(null)}catch(e){b(e instanceof Error?e.message:"Error al guardar")}};return t?(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),(0,r.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})}):(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[v&&(0,r.jsx)(c.Fc,{variant:"destructive",children:(0,r.jsx)(c.TN,{children:v})}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(m.A,{className:"h-6 w-6 text-purple-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Gesti\xf3n de Departamentos"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Administra los departamentos de la empresa"})]})]}),(0,r.jsxs)(l.$,{onClick:()=>{_(null),j(!0)},className:"flex items-center gap-2",children:[(0,r.jsx)(p.A,{className:"h-4 w-4"}),"Nuevo Departamento"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(m.A,{className:"h-5 w-5 text-purple-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-purple-800",children:"Total Departamentos"})]}),(0,r.jsx)("div",{className:"text-2xl font-bold text-purple-900",children:e.length})]}),(0,r.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(h.A,{className:"h-5 w-5 text-blue-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-blue-800",children:"Total Empleados"})]}),(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-900",children:e.reduce((e,a)=>e+a.team_size,0)})]}),(0,r.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(x.A,{className:"h-5 w-5 text-green-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-green-800",children:"Vacantes Abiertas"})]}),(0,r.jsx)("div",{className:"text-2xl font-bold text-green-900",children:e.reduce((e,a)=>e+a.open_positions,0)})]}),(0,r.jsxs)("div",{className:"bg-orange-50 p-4 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(g.A,{className:"h-5 w-5 text-orange-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-orange-800",children:"Satisfacci\xf3n Promedio"})]}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-orange-900",children:[e.length>0?Math.round(e.reduce((e,a)=>e+a.metadata.employee_satisfaction,0)/e.length):0,"%"]})]})]}),(0,r.jsx)(n.A,{data:z,columns:D,actions:L,searchable:!0,searchTerm:E,onSearchChange:q,filters:F,pagination:{current:N,total:Math.ceil($.length/10),pageSize:10},onPageChange:k}),(0,r.jsx)(d.lG,{open:y,onOpenChange:j,children:(0,r.jsxs)(d.Cf,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)(d.c7,{children:(0,r.jsx)(d.L3,{children:w?"Editar Departamento":"Nuevo Departamento"})}),(0,r.jsx)(o.A,{fields:[{key:"name",label:"Nombre del Departamento",type:"text",required:!0,validation:{min:2,max:100}},{key:"slug",label:"Slug (URL)",type:"text",required:!0,placeholder:"ingenieria-infraestructura",validation:{pattern:"^[a-z0-9-]+$",custom:e=>/^[a-z0-9-]+$/.test(e)?null:"El slug solo puede contener letras min\xfasculas, n\xfameros y guiones"}},{key:"description",label:"Descripci\xf3n",type:"textarea",required:!0,validation:{max:500}},{key:"location",label:"Ubicaci\xf3n",type:"text",required:!0,placeholder:"Lima, Per\xfa"},{key:"working_model",label:"Modalidad de Trabajo",type:"select",required:!0,options:[{value:"onsite",label:"Presencial"},{value:"hybrid",label:"H\xedbrido"},{value:"remote",label:"Remoto"}]},{key:"head",label:"Jefe de \xc1rea",type:"text",required:!0,group:"Liderazgo"},{key:"head_email",label:"Email del Jefe",type:"email",required:!0,group:"Liderazgo"},{key:"head_avatar",label:"Avatar del Jefe (URL)",type:"url",group:"Liderazgo",placeholder:"https://ejemplo.com/avatar.jpg"},{key:"team_size",label:"Tama\xf1o del Equipo",type:"number",required:!0,validation:{min:1,max:1e3},group:"Equipo"},{key:"open_positions",label:"Posiciones Abiertas",type:"number",required:!0,validation:{min:0,max:100},group:"Equipo"},{key:"budget.annual",label:"Presupuesto Anual (USD)",type:"number",required:!0,validation:{min:0},group:"Presupuesto"},{key:"budget.allocated",label:"Presupuesto Asignado (USD)",type:"number",required:!0,validation:{min:0},group:"Presupuesto"},{key:"metadata.avg_salary",label:"Salario Promedio (USD)",type:"number",required:!0,validation:{min:0},group:"M\xe9tricas"},{key:"metadata.employee_satisfaction",label:"Satisfacci\xf3n de Empleados (%)",type:"number",required:!0,validation:{min:0,max:100},group:"M\xe9tricas"},{key:"metadata.turnover_rate",label:"Tasa de Rotaci\xf3n (%)",type:"number",required:!0,validation:{min:0,max:100},group:"M\xe9tricas"},{key:"skills_required",label:"Habilidades Requeridas",type:"tags",required:!0,placeholder:"Escriba habilidades y presione Enter"},{key:"benefits",label:"Beneficios del Departamento",type:"tags",placeholder:"Escriba beneficios y presione Enter"},{key:"status",label:"Estado",type:"select",required:!0,options:[{value:"active",label:"Activo"},{value:"inactive",label:"Inactivo"}]}],initialValues:(e=>e?{name:e.name,slug:e.slug,description:e.description,head:e.head,head_email:e.head_email,head_avatar:e.head_avatar,location:e.location,team_size:e.team_size,open_positions:e.open_positions,"budget.annual":e.budget.annual,"budget.allocated":e.budget.allocated,"metadata.avg_salary":e.metadata.avg_salary,"metadata.employee_satisfaction":e.metadata.employee_satisfaction,"metadata.turnover_rate":e.metadata.turnover_rate,skills_required:e.skills_required,benefits:e.benefits,working_model:e.working_model,status:e.status}:{})(w),onSubmit:I,onCancel:()=>{j(!1),_(null)},submitLabel:w?"Actualizar Departamento":"Crear Departamento"})]})})]})}},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19659:(e,a,t)=>{Promise.resolve().then(t.bind(t,8138))},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79551:e=>{"use strict";e.exports=require("url")},86401:(e,a,t)=>{"use strict";async function r(e,a){let t=e.headers.get("content-type");if(!t||!t.includes("application/json")){if(!await e.text())return null;throw Error(`Expected JSON response, got: ${t}`)}try{let a=await e.text();if(!a.trim())return null;return JSON.parse(a)}catch(e){throw Error(`Invalid JSON response from ${a}: ${e instanceof Error?e.message:"Unknown JSON parse error"}`)}}async function s(e,a={}){return fetch(e,{...a,headers:{"Content-Type":"application/json",...a.headers||{}}})}t.d(a,{Ay:()=>i});let i={get:async function(e){try{let a=await s(e);if(!a.ok){let e=await a.text();throw Error(`API Error (${a.status}): ${e}`)}return await r(a,e)}catch(a){if(a instanceof TypeError&&a.message.includes("fetch"))throw Error(`Network error: Failed to fetch from ${e}. Check your internet connection.`);throw a}},post:async function(e,a){try{let t=await s(e,{method:"POST",body:JSON.stringify(a)});if(!t.ok){let e=await t.text();throw Error(`API Error (${t.status}): ${e}`)}return await r(t,e)}catch(a){if(a instanceof TypeError&&a.message.includes("fetch"))throw Error(`Network error: Failed to post to ${e}. Check your internet connection.`);throw a}},put:async function(e,a){try{let t=await s(e,{method:"PUT",body:JSON.stringify(a)});if(!t.ok){let e=await t.text();throw Error(`API Error (${t.status}): ${e}`)}return await r(t,e)}catch(a){if(a instanceof TypeError&&a.message.includes("fetch"))throw Error(`Network error: Failed to update ${e}. Check your internet connection.`);throw a}},delete:async function(e){try{let a=await s(e,{method:"DELETE"});if(!a.ok){let e=await a.text();throw Error(`API Error (${a.status}): ${e}`)}if(204===a.status)return null;return await r(a,e)}catch(a){if(a instanceof TypeError&&a.message.includes("fetch"))throw Error(`Network error: Failed to delete from ${e}. Check your internet connection.`);throw a}},fetch:s}},91821:(e,a,t)=>{"use strict";t.d(a,{Fc:()=>l,TN:()=>d});var r=t(60687),s=t(43210),i=t(24224),n=t(4780);let o=(0,i.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=s.forwardRef(({className:e,variant:a,...t},s)=>(0,r.jsx)("div",{ref:s,role:"alert",className:(0,n.cn)(o({variant:a}),e),...t}));l.displayName="Alert",s.forwardRef(({className:e,...a},t)=>(0,r.jsx)("h5",{ref:t,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",e),...a})).displayName="AlertTitle";let d=s.forwardRef(({className:e,...a},t)=>(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",e),...a}));d.displayName="AlertDescription"},95683:(e,a,t)=>{Promise.resolve().then(t.bind(t,16308))}};var a=require("../../../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),r=a.X(0,[4447,4354,1658,5814,1141,7903,1801,3794,263,601,5125,212,5683],()=>t(262));module.exports=r})();