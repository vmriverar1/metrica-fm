(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4173],{2856:(e,t,a)=>{Promise.resolve().then(a.bind(a,52811))},19637:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(40157).A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},22436:(e,t,a)=>{"use strict";var r=a(12115),s="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},l=r.useState,i=r.useEffect,n=r.useLayoutEffect,o=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!s(e,a)}catch(e){return!0}}var d="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var a=t(),r=l({inst:{value:a,getSnapshot:t}}),s=r[0].inst,d=r[1];return n(function(){s.value=a,s.getSnapshot=t,c(s)&&d({inst:s})},[e,a,t]),i(function(){return c(s)&&d({inst:s}),e(function(){c(s)&&d({inst:s})})},[e]),o(a),a};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:d},49033:(e,t,a)=>{"use strict";e.exports=a(22436)},52811:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g});var r=a(95155),s=a(12115),l=a(90697),i=a(75676),n=a(62543),o=a(30285),c=a(54165),d=a(55365),u=a(26126),m=a(91394),h=a(50286),f=a(18046),p=a(91467),x=a(19637),v=a(51920);let g=()=>{let[e,t]=(0,s.useState)([]),[a,g]=(0,s.useState)(!0),[w,y]=(0,s.useState)(null),[b,N]=(0,s.useState)(!1),[j,k]=(0,s.useState)(null),[E,S]=(0,s.useState)(1),[A,_]=(0,s.useState)(""),[C,L]=(0,s.useState)("all"),T=async()=>{try{g(!0);let e=await l.Ay.get("/api/admin/newsletter/authors");t(e.authors||[])}catch(e){y(e instanceof Error?e.message:"Error desconocido")}finally{g(!1)}};(0,s.useEffect)(()=>{T()},[]);let I=e.filter(e=>{let t=e.name.toLowerCase().includes(A.toLowerCase())||e.email.toLowerCase().includes(A.toLowerCase())||e.role.toLowerCase().includes(A.toLowerCase()),a="all"===C||e.status===C;return t&&a}),O=I.slice((E-1)*10,10*E),q=[{key:"avatar",label:"",render:e=>(0,r.jsxs)(m.eu,{className:"h-10 w-10",children:[(0,r.jsx)(m.BK,{src:e.avatar,alt:e.name}),(0,r.jsx)(m.q5,{children:e.name.substring(0,2).toUpperCase()})]})},{key:"name",label:"Nombre",render:e=>(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium",children:e.name}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:e.email})]})},{key:"role",label:"Rol",render:e=>(0,r.jsx)(u.E,{variant:"outline",children:e.role})},{key:"specialties",label:"Especialidades",render:e=>(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.specialties.slice(0,2).map((e,t)=>(0,r.jsx)(u.E,{variant:"secondary",className:"text-xs",children:e},t)),e.specialties.length>2&&(0,r.jsxs)(u.E,{variant:"secondary",className:"text-xs",children:["+",e.specialties.length-2]})]})},{key:"article_count",label:"Art\xedculos",render:e=>(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"font-medium",children:e.article_count}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:[e.metadata.featured_articles," destacados"]})]})},{key:"status",label:"Estado",render:e=>(0,r.jsx)(u.E,{variant:"active"===e.status?"default":"secondary",children:"active"===e.status?"Activo":"Inactivo"})},{key:"joined_date",label:"Fecha de Ingreso",render:e=>new Date(e.joined_date).toLocaleDateString("es-PE")}],P=[{label:"Editar",onClick:e=>{k(e),N(!0)},variant:"default"},{label:"Ver Art\xedculos",onClick:e=>{window.open("/admin/json-crud/newsletter/articles?author=".concat(e.id),"_blank")},variant:"outline"},{label:e=>"active"===e.status?"Desactivar":"Activar",onClick:async e=>{try{await l.Ay.put("/api/admin/newsletter/authors/".concat(e.id),{...e,status:"active"===e.status?"inactive":"active"}),await T()}catch(e){y(e instanceof Error?e.message:"Error al actualizar")}},variant:"outline"},{label:"Eliminar",onClick:async e=>{if(confirm("\xbfEst\xe1s seguro de que quieres eliminar este autor?"))try{await l.Ay.delete("/api/admin/newsletter/authors/".concat(e.id)),await T()}catch(e){y(e instanceof Error?e.message:"Error al eliminar")}},variant:"destructive",confirmMessage:"\xbfEst\xe1s seguro de que quieres eliminar este autor? Esta acci\xf3n no se puede deshacer."}],R=async e=>{try{let t={name:e.name,email:e.email,bio:e.bio,avatar:e.avatar||"",role:e.role,social_links:{linkedin:e["social_links.linkedin"]||"",twitter:e["social_links.twitter"]||"",github:e["social_links.github"]||"",website:e["social_links.website"]||""},specialties:e.specialties||[],status:e.status,joined_date:(null==j?void 0:j.joined_date)||new Date().toISOString(),article_count:(null==j?void 0:j.article_count)||0,metadata:(null==j?void 0:j.metadata)||{last_published:"",total_views:0,featured_articles:0}},a=j?"/api/admin/newsletter/authors/".concat(j.id):"/api/admin/newsletter/authors",r=j?"PUT":"POST",s=await fetch(a,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok){let e=await s.json();throw Error(e.error||"Error al guardar autor")}N(!1),k(null),await T(),y(null)}catch(e){y(e instanceof Error?e.message:"Error al guardar")}};return a?(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),(0,r.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})}):(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[w&&(0,r.jsx)(d.Fc,{variant:"destructive",children:(0,r.jsx)(d.TN,{children:w})}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(h.A,{className:"h-6 w-6 text-blue-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Gesti\xf3n de Autores"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Administra los autores del newsletter"})]})]}),(0,r.jsxs)(o.$,{onClick:()=>{k(null),N(!0)},className:"flex items-center gap-2",children:[(0,r.jsx)(f.A,{className:"h-4 w-4"}),"Nuevo Autor"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(h.A,{className:"h-5 w-5 text-blue-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-blue-800",children:"Total Autores"})]}),(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-900",children:e.length})]}),(0,r.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(p.A,{className:"h-5 w-5 text-green-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-green-800",children:"Autores Activos"})]}),(0,r.jsx)("div",{className:"text-2xl font-bold text-green-900",children:e.filter(e=>"active"===e.status).length})]}),(0,r.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(x.A,{className:"h-5 w-5 text-purple-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-purple-800",children:"Total Art\xedculos"})]}),(0,r.jsx)("div",{className:"text-2xl font-bold text-purple-900",children:e.reduce((e,t)=>e+t.article_count,0)})]}),(0,r.jsxs)("div",{className:"bg-orange-50 p-4 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(v.A,{className:"h-5 w-5 text-orange-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-orange-800",children:"Este Mes"})]}),(0,r.jsx)("div",{className:"text-2xl font-bold text-orange-900",children:e.filter(e=>new Date(e.metadata.last_published)>new Date(Date.now()-2592e6)).length})]})]}),(0,r.jsx)(i.A,{data:O,columns:q,actions:P,searchable:!0,searchTerm:A,onSearchChange:_,filters:[{key:"status",label:"Estado",options:[{value:"all",label:"Todos"},{value:"active",label:"Activos"},{value:"inactive",label:"Inactivos"}],value:C,onChange:L}],pagination:{current:E,total:Math.ceil(I.length/10),pageSize:10},onPageChange:S}),(0,r.jsx)(c.lG,{open:b,onOpenChange:N,children:(0,r.jsxs)(c.Cf,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)(c.c7,{children:(0,r.jsx)(c.L3,{children:j?"Editar Autor":"Nuevo Autor"})}),(0,r.jsx)(n.A,{fields:[{key:"name",label:"Nombre Completo",type:"text",required:!0,validation:{min:2,max:100}},{key:"email",label:"Email",type:"email",required:!0},{key:"role",label:"Rol",type:"text",required:!0,placeholder:"ej. Especialista en Infraestructura"},{key:"bio",label:"Biograf\xeda",type:"textarea",required:!0,validation:{max:500}},{key:"avatar",label:"URL de Avatar",type:"url",placeholder:"https://ejemplo.com/avatar.jpg"},{key:"specialties",label:"Especialidades",type:"tags",required:!0,placeholder:"Escriba especialidades y presione Enter"},{key:"social_links.linkedin",label:"LinkedIn",type:"url",group:"Enlaces Sociales",placeholder:"https://linkedin.com/in/usuario"},{key:"social_links.twitter",label:"Twitter",type:"url",group:"Enlaces Sociales",placeholder:"https://twitter.com/usuario"},{key:"social_links.github",label:"GitHub",type:"url",group:"Enlaces Sociales",placeholder:"https://github.com/usuario"},{key:"social_links.website",label:"Sitio Web Personal",type:"url",group:"Enlaces Sociales",placeholder:"https://mipagina.com"},{key:"status",label:"Estado",type:"select",required:!0,options:[{value:"active",label:"Activo"},{value:"inactive",label:"Inactivo"}]}],initialValues:(e=>e?{name:e.name,email:e.email,bio:e.bio,avatar:e.avatar,role:e.role,specialties:e.specialties,"social_links.linkedin":e.social_links.linkedin||"","social_links.twitter":e.social_links.twitter||"","social_links.github":e.social_links.github||"","social_links.website":e.social_links.website||"",status:e.status}:{})(j),onSubmit:R,onCancel:()=>{N(!1),k(null)},submitLabel:j?"Actualizar Autor":"Crear Autor"})]})})]})}},54011:(e,t,a)=>{"use strict";a.d(t,{H4:()=>k,_V:()=>j,bL:()=>N});var r=a(12115),s=a(46081),l=a(39033),i=a(52712),n=a(63655),o=a(49033);function c(){return()=>{}}var d=a(95155),u="Avatar",[m,h]=(0,s.A)(u),[f,p]=m(u),x=r.forwardRef((e,t)=>{let{__scopeAvatar:a,...s}=e,[l,i]=r.useState("idle");return(0,d.jsx)(f,{scope:a,imageLoadingStatus:l,onImageLoadingStatusChange:i,children:(0,d.jsx)(n.sG.span,{...s,ref:t})})});x.displayName=u;var v="AvatarImage",g=r.forwardRef((e,t)=>{let{__scopeAvatar:a,src:s,onLoadingStatusChange:u=()=>{},...m}=e,h=p(v,a),f=function(e,t){let{referrerPolicy:a,crossOrigin:s}=t,l=(0,o.useSyncExternalStore)(c,()=>!0,()=>!1),n=r.useRef(null),d=l?(n.current||(n.current=new window.Image),n.current):null,[u,m]=r.useState(()=>b(d,e));return(0,i.N)(()=>{m(b(d,e))},[d,e]),(0,i.N)(()=>{let e=e=>()=>{m(e)};if(!d)return;let t=e("loaded"),r=e("error");return d.addEventListener("load",t),d.addEventListener("error",r),a&&(d.referrerPolicy=a),"string"==typeof s&&(d.crossOrigin=s),()=>{d.removeEventListener("load",t),d.removeEventListener("error",r)}},[d,s,a]),u}(s,m),x=(0,l.c)(e=>{u(e),h.onImageLoadingStatusChange(e)});return(0,i.N)(()=>{"idle"!==f&&x(f)},[f,x]),"loaded"===f?(0,d.jsx)(n.sG.img,{...m,ref:t,src:s}):null});g.displayName=v;var w="AvatarFallback",y=r.forwardRef((e,t)=>{let{__scopeAvatar:a,delayMs:s,...l}=e,i=p(w,a),[o,c]=r.useState(void 0===s);return r.useEffect(()=>{if(void 0!==s){let e=window.setTimeout(()=>c(!0),s);return()=>window.clearTimeout(e)}},[s]),o&&"loaded"!==i.imageLoadingStatus?(0,d.jsx)(n.sG.span,{...l,ref:t}):null});function b(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}y.displayName=w;var N=x,j=g,k=y},55365:(e,t,a)=>{"use strict";a.d(t,{Fc:()=>o,TN:()=>c});var r=a(95155),s=a(12115),l=a(74466),i=a(59434);let n=(0,l.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=s.forwardRef((e,t)=>{let{className:a,variant:s,...l}=e;return(0,r.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(n({variant:s}),a),...l})});o.displayName="Alert",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",a),...s})}).displayName="AlertTitle";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",a),...s})});c.displayName="AlertDescription"},90697:(e,t,a)=>{"use strict";async function r(e,t){let a=e.headers.get("content-type");if(!a||!a.includes("application/json")){if(!await e.text())return null;throw Error("Expected JSON response, got: ".concat(a))}try{let t=await e.text();if(!t.trim())return null;return JSON.parse(t)}catch(e){throw Error("Invalid JSON response from ".concat(t,": ").concat(e instanceof Error?e.message:"Unknown JSON parse error"))}}async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=function(){let e=localStorage.getItem("auth-token"),t={"Content-Type":"application/json"};return e&&(t.Authorization="Bearer ".concat(e)),t}();return fetch(e,{...t,headers:{...a,...t.headers||{}}})}a.d(t,{Ay:()=>l});let l={get:async function(e){try{let t=await s(e);if(!t.ok){let e=await t.text();throw Error("API Error (".concat(t.status,"): ").concat(e))}return await r(t,e)}catch(t){if(t instanceof TypeError&&t.message.includes("fetch"))throw Error("Network error: Failed to fetch from ".concat(e,". Check your internet connection."));throw t}},post:async function(e,t){try{let a=await s(e,{method:"POST",body:JSON.stringify(t)});if(!a.ok){let e=await a.text();throw Error("API Error (".concat(a.status,"): ").concat(e))}return await r(a,e)}catch(t){if(t instanceof TypeError&&t.message.includes("fetch"))throw Error("Network error: Failed to post to ".concat(e,". Check your internet connection."));throw t}},put:async function(e,t){try{let a=await s(e,{method:"PUT",body:JSON.stringify(t)});if(!a.ok){let e=await a.text();throw Error("API Error (".concat(a.status,"): ").concat(e))}return await r(a,e)}catch(t){if(t instanceof TypeError&&t.message.includes("fetch"))throw Error("Network error: Failed to update ".concat(e,". Check your internet connection."));throw t}},delete:async function(e){try{let t=await s(e,{method:"DELETE"});if(!t.ok){let e=await t.text();throw Error("API Error (".concat(t.status,"): ").concat(e))}if(204===t.status)return null;return await r(t,e)}catch(t){if(t instanceof TypeError&&t.message.includes("fetch"))throw Error("Network error: Failed to delete from ".concat(e,". Check your internet connection."));throw t}},fetch:s}},91394:(e,t,a)=>{"use strict";a.d(t,{BK:()=>o,eu:()=>n,q5:()=>c});var r=a(95155),s=a(12115),l=a(54011),i=a(59434);let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l.bL,{ref:t,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...s})});n.displayName=l.bL.displayName;let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l._V,{ref:t,className:(0,i.cn)("aspect-square h-full w-full",a),...s})});o.displayName=l._V.displayName;let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l.H4,{ref:t,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...s})});c.displayName=l.H4.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[4277,2536,9550,7328,8965,4198,9658,1781,7615,2192,8441,1684,7358],()=>t(2856)),_N_E=e.O()}]);