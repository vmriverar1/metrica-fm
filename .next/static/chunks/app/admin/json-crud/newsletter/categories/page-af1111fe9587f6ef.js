(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5083],{13556:(e,t,a)=>{Promise.resolve().then(a.bind(a,49809))},49809:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>v});var r=a(95155),s=a(12115),l=a(90697),i=a(75676),n=a(62543),o=a(30285),c=a(54165),d=a(55365),u=a(26126),m=a(53054),x=a(18046),h=a(82733),g=a(15300),p=a(80659);let v=()=>{let[e,t]=(0,s.useState)([]),[a,v]=(0,s.useState)(!0),[f,y]=(0,s.useState)(null),[w,b]=(0,s.useState)(!1),[N,j]=(0,s.useState)(null),[k,E]=(0,s.useState)(1),[C,A]=(0,s.useState)(""),[_,S]=(0,s.useState)("all"),T=async()=>{try{v(!0);let e=await l.Ay.get("/api/admin/newsletter/categories");t(e.categories||[])}catch(e){y(e instanceof Error?e.message:"Error desconocido")}finally{v(!1)}};(0,s.useEffect)(()=>{T()},[]);let O=e.filter(e=>{let t=e.name.toLowerCase().includes(C.toLowerCase())||e.description.toLowerCase().includes(C.toLowerCase()),a="all"===_||e.status===_;return t&&a}),q=O.slice((k-1)*10,10*k),z=[{key:"color",label:"",render:e=>(0,r.jsx)("div",{className:"w-4 h-4 rounded-full border border-gray-300",style:{backgroundColor:e.color}})},{key:"name",label:"Nombre",render:e=>(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"text-lg",children:e.icon}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium",children:e.name}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["/",e.slug]})]})]})},{key:"description",label:"Descripci\xf3n",render:e=>(0,r.jsx)("div",{className:"max-w-xs truncate text-sm text-gray-600",children:e.description})},{key:"article_count",label:"Art\xedculos",render:e=>(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"font-medium",children:e.article_count}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:[e.metadata.featured_articles," destacados"]})]})},{key:"metadata.total_views",label:"Vistas Totales",render:e=>(0,r.jsx)("div",{className:"text-right font-mono text-sm",children:e.metadata.total_views.toLocaleString()})},{key:"order",label:"Orden",render:e=>(0,r.jsx)(u.E,{variant:"outline",children:e.order})},{key:"status",label:"Estado",render:e=>(0,r.jsx)(u.E,{variant:"active"===e.status?"default":"secondary",children:"active"===e.status?"Activa":"Inactiva"})}],I=[{label:"Editar",onClick:e=>{j(e),b(!0)},variant:"default"},{label:"Ver Art\xedculos",onClick:e=>{window.open("/admin/json-crud/newsletter/articles?category=".concat(e.slug),"_blank")},variant:"outline"},{label:"Subir",onClick:async e=>{let t=Math.max(1,e.order-1);await P(e.id,t)},variant:"outline",disabled:e=>1===e.order},{label:"Bajar",onClick:async t=>{let a=Math.min(Math.max(...e.map(e=>e.order)),t.order+1);await P(t.id,a)},variant:"outline",disabled:t=>t.order===Math.max(...e.map(e=>e.order))},{label:e=>"active"===e.status?"Desactivar":"Activar",onClick:async e=>{try{await l.Ay.put("/api/admin/newsletter/categories/".concat(e.id),{...e,status:"active"===e.status?"inactive":"active"})}catch(e){y(e instanceof Error?e.message:"Error al actualizar")}},variant:"outline"},{label:"Eliminar",onClick:async e=>{if(confirm("\xbfEst\xe1s seguro de que quieres eliminar esta categor\xeda?"))try{await l.Ay.delete("/api/admin/newsletter/categories/".concat(e.id))}catch(e){y(e instanceof Error?e.message:"Error al eliminar")}},variant:"destructive",confirmMessage:"\xbfEst\xe1s seguro de que quieres eliminar esta categor\xeda? Esta acci\xf3n no se puede deshacer."}],P=async(t,a)=>{try{let r=e.find(e=>e.id===t);if(!r)return;await l.Ay.put("/api/admin/newsletter/categories/".concat(t),{...r,order:a})}catch(e){y(e instanceof Error?e.message:"Error al actualizar orden")}},F=async e=>{try{let t={name:e.name,slug:e.slug,description:e.description,color:e.color,icon:e.icon,order:parseInt(e.order),status:e.status,article_count:(null==N?void 0:N.article_count)||0,metadata:(null==N?void 0:N.metadata)||{total_views:0,avg_reading_time:0,featured_articles:0,last_article_date:""},seo:{meta_title:e["seo.meta_title"]||"",meta_description:e["seo.meta_description"]||"",keywords:e["seo.keywords"]||[]}},a=N?"/api/admin/newsletter/categories/".concat(N.id):"/api/admin/newsletter/categories",r=N?"PUT":"POST",s=await fetch(a,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok){let e=await s.json();throw Error(e.error||"Error al guardar categor\xeda")}b(!1),j(null),await T(),y(null)}catch(e){y(e instanceof Error?e.message:"Error al guardar")}};return a?(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),(0,r.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})}):(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[f&&(0,r.jsx)(d.Fc,{variant:"destructive",children:(0,r.jsx)(d.TN,{children:f})}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(m.A,{className:"h-6 w-6 text-green-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Gesti\xf3n de Categor\xedas"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Administra las categor\xedas del newsletter"})]})]}),(0,r.jsxs)(o.$,{onClick:()=>{j(null),b(!0)},className:"flex items-center gap-2",children:[(0,r.jsx)(x.A,{className:"h-4 w-4"}),"Nueva Categor\xeda"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(m.A,{className:"h-5 w-5 text-green-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-green-800",children:"Total Categor\xedas"})]}),(0,r.jsx)("div",{className:"text-2xl font-bold text-green-900",children:e.length})]}),(0,r.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(h.A,{className:"h-5 w-5 text-blue-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-blue-800",children:"Activas"})]}),(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-900",children:e.filter(e=>"active"===e.status).length})]}),(0,r.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(g.A,{className:"h-5 w-5 text-purple-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-purple-800",children:"Total Art\xedculos"})]}),(0,r.jsx)("div",{className:"text-2xl font-bold text-purple-900",children:e.reduce((e,t)=>e+t.article_count,0)})]}),(0,r.jsxs)("div",{className:"bg-orange-50 p-4 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(p.A,{className:"h-5 w-5 text-orange-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-orange-800",children:"Total Vistas"})]}),(0,r.jsx)("div",{className:"text-2xl font-bold text-orange-900",children:e.reduce((e,t)=>e+t.metadata.total_views,0).toLocaleString()})]})]}),(0,r.jsx)(i.A,{data:q,columns:z,actions:I,searchable:!0,searchTerm:C,onSearchChange:A,filters:[{key:"status",label:"Estado",options:[{value:"all",label:"Todas"},{value:"active",label:"Activas"},{value:"inactive",label:"Inactivas"}],value:_,onChange:S}],pagination:{current:k,total:Math.ceil(O.length/10),pageSize:10},onPageChange:E}),(0,r.jsx)(c.lG,{open:w,onOpenChange:b,children:(0,r.jsxs)(c.Cf,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)(c.c7,{children:(0,r.jsx)(c.L3,{children:N?"Editar Categor\xeda":"Nueva Categor\xeda"})}),(0,r.jsx)(n.A,{fields:[{key:"name",label:"Nombre de la Categor\xeda",type:"text",required:!0,validation:{min:2,max:50}},{key:"slug",label:"Slug (URL)",type:"text",required:!0,placeholder:"tecnologia-innovacion",validation:{pattern:"^[a-z0-9-]+$",custom:e=>/^[a-z0-9-]+$/.test(e)?null:"El slug solo puede contener letras min\xfasculas, n\xfameros y guiones"}},{key:"description",label:"Descripci\xf3n",type:"textarea",required:!0,validation:{max:200}},{key:"color",label:"Color de la Categor\xeda",type:"text",required:!0,placeholder:"#3B82F6",validation:{pattern:"^#[0-9A-Fa-f]{6}$",custom:e=>/^#[0-9A-Fa-f]{6}$/.test(e)?null:"Ingrese un color hexadecimal v\xe1lido (ej: #3B82F6)"}},{key:"icon",label:"Icono (Emoji)",type:"text",required:!0,placeholder:"\uD83D\uDE80",validation:{max:2}},{key:"order",label:"Orden de Visualizaci\xf3n",type:"number",required:!0,validation:{min:1,max:100}},{key:"seo.meta_title",label:"T\xedtulo SEO",type:"text",group:"SEO",validation:{max:60},placeholder:"T\xedtulo optimizado para motores de b\xfasqueda"},{key:"seo.meta_description",label:"Descripci\xf3n SEO",type:"textarea",group:"SEO",validation:{max:160},placeholder:"Descripci\xf3n optimizada para motores de b\xfasqueda"},{key:"seo.keywords",label:"Palabras Clave",type:"tags",group:"SEO",placeholder:"Escriba palabras clave y presione Enter"},{key:"status",label:"Estado",type:"select",required:!0,options:[{value:"active",label:"Activa"},{value:"inactive",label:"Inactiva"}]}],initialValues:(t=>t?{name:t.name,slug:t.slug,description:t.description,color:t.color,icon:t.icon,order:t.order,"seo.meta_title":t.seo.meta_title,"seo.meta_description":t.seo.meta_description,"seo.keywords":t.seo.keywords,status:t.status}:{order:e.length+1})(N),onSubmit:F,onCancel:()=>{b(!1),j(null)},submitLabel:N?"Actualizar Categor\xeda":"Crear Categor\xeda"})]})})]})}},55365:(e,t,a)=>{"use strict";a.d(t,{Fc:()=>o,TN:()=>c});var r=a(95155),s=a(12115),l=a(74466),i=a(59434);let n=(0,l.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=s.forwardRef((e,t)=>{let{className:a,variant:s,...l}=e;return(0,r.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(n({variant:s}),a),...l})});o.displayName="Alert",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",a),...s})}).displayName="AlertTitle";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",a),...s})});c.displayName="AlertDescription"},82733:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(40157).A)("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]])},90697:(e,t,a)=>{"use strict";async function r(e,t){let a=e.headers.get("content-type");if(!a||!a.includes("application/json")){if(!await e.text())return null;throw Error("Expected JSON response, got: ".concat(a))}try{let t=await e.text();if(!t.trim())return null;return JSON.parse(t)}catch(e){throw Error("Invalid JSON response from ".concat(t,": ").concat(e instanceof Error?e.message:"Unknown JSON parse error"))}}async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=function(){let e=localStorage.getItem("auth-token"),t={"Content-Type":"application/json"};return e&&(t.Authorization="Bearer ".concat(e)),t}();return fetch(e,{...t,headers:{...a,...t.headers||{}}})}a.d(t,{Ay:()=>l});let l={get:async function(e){try{let t=await s(e);if(!t.ok){let e=await t.text();throw Error("API Error (".concat(t.status,"): ").concat(e))}return await r(t,e)}catch(t){if(t instanceof TypeError&&t.message.includes("fetch"))throw Error("Network error: Failed to fetch from ".concat(e,". Check your internet connection."));throw t}},post:async function(e,t){try{let a=await s(e,{method:"POST",body:JSON.stringify(t)});if(!a.ok){let e=await a.text();throw Error("API Error (".concat(a.status,"): ").concat(e))}return await r(a,e)}catch(t){if(t instanceof TypeError&&t.message.includes("fetch"))throw Error("Network error: Failed to post to ".concat(e,". Check your internet connection."));throw t}},put:async function(e,t){try{let a=await s(e,{method:"PUT",body:JSON.stringify(t)});if(!a.ok){let e=await a.text();throw Error("API Error (".concat(a.status,"): ").concat(e))}return await r(a,e)}catch(t){if(t instanceof TypeError&&t.message.includes("fetch"))throw Error("Network error: Failed to update ".concat(e,". Check your internet connection."));throw t}},delete:async function(e){try{let t=await s(e,{method:"DELETE"});if(!t.ok){let e=await t.text();throw Error("API Error (".concat(t.status,"): ").concat(e))}if(204===t.status)return null;return await r(t,e)}catch(t){if(t instanceof TypeError&&t.message.includes("fetch"))throw Error("Network error: Failed to delete from ".concat(e,". Check your internet connection."));throw t}},fetch:s}}},e=>{var t=t=>e(e.s=t);e.O(0,[4277,2536,9550,7328,8965,4198,9658,1781,7615,2192,8441,1684,7358],()=>t(13556)),_N_E=e.O()}]);