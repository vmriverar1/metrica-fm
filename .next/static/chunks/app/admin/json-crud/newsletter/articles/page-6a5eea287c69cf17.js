(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3868],{9658:(e,a,t)=>{"use strict";t.d(a,{A:()=>r});let r=(0,t(40157).A)("PenTool",[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]])},35695:(e,a,t)=>{"use strict";var r=t(18999);t.o(r,"notFound")&&t.d(a,{notFound:function(){return r.notFound}}),t.o(r,"usePathname")&&t.d(a,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(a,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(a,{useSearchParams:function(){return r.useSearchParams}})},58997:(e,a,t)=>{Promise.resolve().then(t.bind(t,94542))},90697:(e,a,t)=>{"use strict";async function r(e,a){let t=e.headers.get("content-type");if(!t||!t.includes("application/json")){if(!await e.text())return null;throw Error("Expected JSON response, got: ".concat(t))}try{let a=await e.text();if(!a.trim())return null;return JSON.parse(a)}catch(e){throw Error("Invalid JSON response from ".concat(a,": ").concat(e instanceof Error?e.message:"Unknown JSON parse error"))}}async function l(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=function(){let e=localStorage.getItem("auth-token"),a={"Content-Type":"application/json"};return e&&(a.Authorization="Bearer ".concat(e)),a}();return fetch(e,{...a,headers:{...t,...a.headers||{}}})}t.d(a,{Ay:()=>s});let s={get:async function(e){try{let a=await l(e);if(!a.ok){let e=await a.text();throw Error("API Error (".concat(a.status,"): ").concat(e))}return await r(a,e)}catch(a){if(a instanceof TypeError&&a.message.includes("fetch"))throw Error("Network error: Failed to fetch from ".concat(e,". Check your internet connection."));throw a}},post:async function(e,a){try{let t=await l(e,{method:"POST",body:JSON.stringify(a)});if(!t.ok){let e=await t.text();throw Error("API Error (".concat(t.status,"): ").concat(e))}return await r(t,e)}catch(a){if(a instanceof TypeError&&a.message.includes("fetch"))throw Error("Network error: Failed to post to ".concat(e,". Check your internet connection."));throw a}},put:async function(e,a){try{let t=await l(e,{method:"PUT",body:JSON.stringify(a)});if(!t.ok){let e=await t.text();throw Error("API Error (".concat(t.status,"): ").concat(e))}return await r(t,e)}catch(a){if(a instanceof TypeError&&a.message.includes("fetch"))throw Error("Network error: Failed to update ".concat(e,". Check your internet connection."));throw a}},delete:async function(e){try{let a=await l(e,{method:"DELETE"});if(!a.ok){let e=await a.text();throw Error("API Error (".concat(a.status,"): ").concat(e))}if(204===a.status)return null;return await r(a,e)}catch(a){if(a instanceof TypeError&&a.message.includes("fetch"))throw Error("Network error: Failed to delete from ".concat(e,". Check your internet connection."));throw a}},fetch:l}},91721:(e,a,t)=>{"use strict";t.d(a,{A:()=>r});let r=(0,t(40157).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},94542:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>j});var r=t(95155),l=t(12115),s=t(90697),o=t(35695),i=t(15300),n=t(30462),c=t(91721),d=t(37648),u=t(51920),m=t(53054),p=t(17607),h=t(61840),x=t(18763),g=t(77223),y=t(18046),b=t(9658),f=t(31949),w=t(75676),v=t(62543);function j(){let[e,a]=(0,l.useState)([]),[t,j]=(0,l.useState)([]),[N,k]=(0,l.useState)([]),[E,A]=(0,l.useState)(!0),[S,_]=(0,l.useState)({page:1,limit:20,total:0,totalPages:0,hasNextPage:!1,hasPrevPage:!1}),[C,P]=(0,l.useState)({}),[T,q]=(0,l.useState)(""),[I,D]=(0,l.useState)("published_date"),[O,L]=(0,l.useState)("desc"),[R,F]=(0,l.useState)(!1),[z,M]=(0,l.useState)(null),[J,U]=(0,l.useState)(null),B=(0,o.useSearchParams)();(0,l.useEffect)(()=>{"create"===B.get("action")&&F(!0)},[B]),(0,l.useEffect)(()=>{H()},[S.page,S.limit,C,T,I,O]);let H=async()=>{A(!0);try{let e=new URLSearchParams({page:S.page.toString(),limit:S.limit.toString(),sort:I,order:O,...T&&{search:T},...C}),t=await s.Ay.get("/api/admin/newsletter/articles?".concat(e));t.success?(a(t.data.articles),j(t.data.authors),k(t.data.categories),_(t.data.pagination)):console.error("Error fetching articles:",t.message)}catch(e){console.error("Error fetching articles:",e)}finally{A(!1)}},V=()=>{M(null),F(!0)},G=async e=>{try{let a=await s.Ay.delete("/api/admin/newsletter/articles/".concat(e.id));a.success?(H(),U(null)):console.error("Error deleting article:",a.message)}catch(e){console.error("Error deleting article:",e)}},K=async e=>{try{let a=z?"/api/admin/newsletter/articles/".concat(z.id):"/api/admin/newsletter/articles",t=z?"PUT":"POST",r=await fetch(a,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),l=await r.json();if(l.success)H(),F(!1),M(null);else throw Error(l.message||"Error saving article")}catch(e){throw console.error("Error saving article:",e),e}},Q=[{key:"featured_image",label:"Imagen",width:"w-20",render:e=>(0,r.jsx)("div",{className:"w-12 h-12 rounded-lg bg-gray-200 overflow-hidden",children:e?(0,r.jsx)("img",{src:e,alt:"",className:"w-full h-full object-cover"}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,r.jsx)(i.A,{className:"w-6 h-6 text-gray-400"})})})},{key:"title",label:"T\xedtulo",sortable:!0,render:(e,a)=>{var t;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"font-medium text-gray-900",children:e}),a.featured&&(0,r.jsx)(n.A,{className:"w-4 h-4 text-yellow-500"})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["/",a.slug]}),(0,r.jsxs)("div",{className:"text-xs text-gray-400 mt-1",children:[null==(t=a.excerpt)?void 0:t.substring(0,60),"..."]})]})}},{key:"author_info",label:"Autor",render:e=>e?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-200 overflow-hidden mr-3",children:e.avatar?(0,r.jsx)("img",{src:e.avatar,alt:e.name,className:"w-full h-full object-cover"}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,r.jsx)(c.A,{className:"w-4 h-4 text-gray-400"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:e.role})]})]}):null},{key:"category_info",label:"Categor\xeda",render:e=>e?(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full",style:{backgroundColor:"".concat(e.color,"20"),color:e.color},children:e.name}):null},{key:"status",label:"Estado",render:(e,a)=>(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("published"===e?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:"published"===e?"Publicado":"Borrador"})},{key:"reading_time",label:"Lectura",render:e=>(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(d.A,{className:"w-4 h-4 text-gray-400 mr-2"}),(0,r.jsxs)("span",{className:"text-sm",children:[e||0," min"]})]})},{key:"published_date",label:"Publicaci\xf3n",sortable:!0,render:(e,a)=>e?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(u.A,{className:"w-4 h-4 text-gray-400 mr-2"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm",children:new Date(e).toLocaleDateString()}),void 0!==a.days_since_published&&(0,r.jsx)("div",{className:"text-xs text-gray-500",children:0===a.days_since_published?"Hoy":1===a.days_since_published?"Ayer":"Hace ".concat(a.days_since_published," d\xedas")})]})]}):(0,r.jsx)("span",{className:"text-gray-400",children:"Sin publicar"})},{key:"tags",label:"Etiquetas",render:e=>(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[null==e?void 0:e.slice(0,2).map((e,a)=>(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[(0,r.jsx)(m.A,{className:"w-3 h-3 mr-1"}),e]},a)),(null==e?void 0:e.length)>2&&(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["+",e.length-2]})]})}],W=[{label:"Ver",icon:p.A,onClick:e=>window.open("/blog/".concat(e.slug),"_blank"),variant:"secondary",show:e=>!!e.published_date},{label:"Vista previa",icon:h.A,onClick:e=>window.open("/admin/preview/article/".concat(e.id),"_blank"),variant:"secondary",show:e=>!e.published_date},{label:"Editar",icon:x.A,onClick:e=>{M(e),F(!0)},variant:"primary"},{label:"Eliminar",icon:g.A,onClick:e=>U(e),variant:"danger"}],X=[{key:"category",label:"Categor\xeda",type:"select",options:N.map(e=>({value:e.id,label:e.name}))},{key:"author_id",label:"Autor",type:"select",options:t.map(e=>({value:e.id,label:e.name}))},{key:"featured",label:"Destacado",type:"select",options:[{value:"true",label:"S\xed"},{value:"false",label:"No"}]},{key:"published",label:"Estado de publicaci\xf3n",type:"select",options:[{value:"true",label:"Publicado"},{value:"false",label:"Borrador"}]}],Y=[{key:"title",label:"T\xedtulo del Art\xedculo",type:"text",required:!0,placeholder:"T\xedtulo del art\xedculo...",group:"basic"},{key:"slug",label:"Slug",type:"text",placeholder:"Se genera autom\xe1ticamente si se deja vac\xedo",description:"URL amigable para el art\xedculo",group:"basic"},{key:"category",label:"Categor\xeda",type:"select",required:!0,options:N.map(e=>({value:e.id,label:e.name})),group:"basic"},{key:"author_id",label:"Autor",type:"select",required:!0,options:t.map(e=>({value:e.id,label:e.name})),group:"basic"},{key:"featured",label:"Art\xedculo Destacado",type:"checkbox",description:"Los art\xedculos destacados aparecen en posiciones prominentes",group:"basic"},{key:"excerpt",label:"Extracto",type:"textarea",required:!0,placeholder:"Resumen del art\xedculo que aparecer\xe1 en listados...",description:"Resumen breve del art\xedculo (m\xe1ximo 160 caracteres recomendado)",validation:{max:200},group:"content"},{key:"content",label:"Contenido",type:"markdown",required:!0,placeholder:"Escribe el contenido del art\xedculo en Markdown...",description:"Contenido completo del art\xedculo en formato Markdown",group:"content"},{key:"featured_image",label:"Imagen Principal",type:"url",placeholder:"https://ejemplo.com/imagen.jpg",description:"URL de la imagen principal del art\xedculo",group:"media"},{key:"featured_image_alt",label:"Texto Alternativo de la Imagen",type:"text",placeholder:"Descripci\xf3n de la imagen...",description:"Texto alternativo para accesibilidad",group:"media"},{key:"social_image",label:"Imagen para Redes Sociales",type:"url",placeholder:"https://ejemplo.com/imagen-social.jpg",description:"Imagen que aparecer\xe1 al compartir en redes sociales",group:"media"},{key:"published_date",label:"Fecha de Publicaci\xf3n",type:"datetime-local",description:"Deja vac\xedo para guardar como borrador",group:"publishing"},{key:"reading_time",label:"Tiempo de Lectura (minutos)",type:"number",placeholder:"0",description:"Se calcula autom\xe1ticamente si se deja vac\xedo",validation:{min:0,max:60},group:"publishing"},{key:"tags",label:"Etiquetas",type:"tags",placeholder:"Separar con comas...",description:"Etiquetas para categorizaci\xf3n y b\xfasqueda",group:"meta"},{key:"seo_description",label:"Meta Descripci\xf3n (SEO)",type:"textarea",placeholder:"Descripci\xf3n para motores de b\xfasqueda...",description:"Descripci\xf3n que aparecer\xe1 en los resultados de b\xfasqueda (m\xe1ximo 160 caracteres)",validation:{max:160},group:"meta"},{key:"related_articles",label:"Art\xedculos Relacionados",type:"tags",placeholder:"IDs de art\xedculos separados por comas...",description:"IDs de otros art\xedculos relacionados",group:"meta"}];return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Gesti\xf3n de Art\xedculos"}),(0,r.jsx)("p",{className:"mt-2 text-gray-600",children:"Administra todos los art\xedculos del blog y newsletter de la empresa."})]}),(0,r.jsx)(w.A,{data:e,columns:Q,actions:W,filters:X,loading:E,pagination:S,onPageChange:e=>_(a=>({...a,page:e})),onLimitChange:e=>_(a=>({...a,limit:e,page:1})),onSortChange:(e,a)=>{D(e),L(a)},onFilterChange:P,onSearch:q,searchPlaceholder:"Buscar art\xedculos...",title:"Art\xedculos del Newsletter",subtitle:"".concat(S.total," art\xedculos en total"),primaryAction:{label:"Nuevo Art\xedculo",onClick:V,icon:y.A},emptyState:(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(b.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No hay art\xedculos"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Comienza creando tu primer art\xedculo del newsletter."}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsxs)("button",{onClick:V,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[(0,r.jsx)(y.A,{className:"w-4 h-4 mr-2"}),"Nuevo Art\xedculo"]})})]})}),R&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,r.jsx)("div",{className:"relative top-10 mx-auto p-5 border w-11/12 max-w-5xl shadow-lg rounded-md bg-white",children:(0,r.jsx)("div",{className:"max-h-screen overflow-y-auto",children:(0,r.jsx)(v.A,{fields:Y,groups:[{name:"basic",label:"Informaci\xf3n B\xe1sica",description:"Datos fundamentales del art\xedculo"},{name:"content",label:"Contenido",description:"Extracto y contenido principal del art\xedculo"},{name:"media",label:"Medios",description:"Im\xe1genes y recursos visuales"},{name:"publishing",label:"Publicaci\xf3n",description:"Configuraci\xf3n de publicaci\xf3n y fechas"},{name:"meta",label:"Metadatos",description:"SEO y configuraci\xf3n adicional",collapsible:!0,defaultExpanded:!1}],initialValues:z||{},onSubmit:K,onCancel:()=>{F(!1),M(null)},title:z?"Editar Art\xedculo":"Nuevo Art\xedculo",subtitle:z?"Modifica los datos del art\xedculo":"Crea un nuevo art\xedculo para el newsletter",mode:z?"edit":"create"})})})}),J&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,r.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)(f.A,{className:"w-6 h-6 text-red-600 mr-3"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Confirmar Eliminaci\xf3n"})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mb-6",children:['\xbfEst\xe1s seguro de que deseas eliminar el art\xedculo "',(0,r.jsx)("strong",{children:J.title}),'"? Esta acci\xf3n no se puede deshacer.']}),(0,r.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,r.jsx)("button",{onClick:()=>U(null),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md",children:"Cancelar"}),(0,r.jsx)("button",{onClick:()=>G(J),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md",children:"Eliminar"})]})]})})})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[4277,2536,9550,7328,8965,4198,9658,1781,7615,2192,8441,1684,7358],()=>a(58997)),_N_E=e.O()}]);