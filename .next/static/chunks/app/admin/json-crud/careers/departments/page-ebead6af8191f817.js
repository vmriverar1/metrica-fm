(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4756],{43453:(e,a,t)=>{Promise.resolve().then(t.bind(t,67878))},55365:(e,a,t)=>{"use strict";t.d(a,{Fc:()=>o,TN:()=>d});var r=t(95155),s=t(12115),i=t(74466),l=t(59434);let n=(0,i.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=s.forwardRef((e,a)=>{let{className:t,variant:s,...i}=e;return(0,r.jsx)("div",{ref:a,role:"alert",className:(0,l.cn)(n({variant:s}),t),...i})});o.displayName="Alert",s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("h5",{ref:a,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",t),...s})}).displayName="AlertTitle";let d=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("div",{ref:a,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",t),...s})});d.displayName="AlertDescription"},67878:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>v});var r=t(95155),s=t(12115),i=t(90697),l=t(75676),n=t(62543),o=t(30285),d=t(54165),c=t(55365),u=t(26126),m=t(83173),p=t(18046),h=t(50286),g=t(57082),x=t(80659);let v=()=>{let[e,a]=(0,s.useState)([]),[t,v]=(0,s.useState)(!0),[b,f]=(0,s.useState)(null),[y,w]=(0,s.useState)(!1),[j,N]=(0,s.useState)(null),[_,k]=(0,s.useState)(1),[E,S]=(0,s.useState)(""),[A,q]=(0,s.useState)("all"),[C,T]=(0,s.useState)("all"),P=async()=>{try{var e;v(!0);let t=await i.Ay.get("/api/admin/careers/departments");a((null==(e=t.data)?void 0:e.departments)||[])}catch(e){f(e instanceof Error?e.message:"Error desconocido")}finally{v(!1)}};(0,s.useEffect)(()=>{P()},[]);let D=e.filter(e=>{let a=e.name.toLowerCase().includes(E.toLowerCase())||e.description.toLowerCase().includes(E.toLowerCase())||e.head.toLowerCase().includes(E.toLowerCase()),t="all"===A||e.status===A,r="all"===C||e.location===C;return a&&t&&r}),z=D.slice((_-1)*10,10*_),L=[{key:"name",label:"Departamento",render:e=>(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium",children:e.name}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:e.location})]})},{key:"head",label:"Jefe de \xc1rea",render:e=>(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("img",{src:e.head_avatar||"/default-avatar.png",alt:e.head,className:"w-8 h-8 rounded-full object-cover"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-sm",children:e.head}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:e.head_email})]})]})},{key:"team_size",label:"Equipo",render:e=>(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"font-medium",children:e.team_size}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"personas"})]})},{key:"open_positions",label:"Vacantes",render:e=>(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)(u.E,{variant:e.open_positions>0?"default":"secondary",children:e.open_positions})})},{key:"working_model",label:"Modalidad",render:e=>(0,r.jsx)(u.E,{className:{remote:"bg-green-100 text-green-800",hybrid:"bg-blue-100 text-blue-800",onsite:"bg-orange-100 text-orange-800"}[e.working_model],children:{remote:"Remoto",hybrid:"H\xedbrido",onsite:"Presencial"}[e.working_model]})},{key:"metadata.employee_satisfaction",label:"Satisfacci\xf3n",render:e=>(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("div",{className:"font-medium",children:[e.metadata.employee_satisfaction,"%"]}),(0,r.jsx)("div",{className:"w-12 bg-gray-200 rounded-full h-2 mx-auto",children:(0,r.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"".concat(e.metadata.employee_satisfaction,"%")}})})]})},{key:"status",label:"Estado",render:e=>(0,r.jsx)(u.E,{variant:"active"===e.status?"default":"secondary",children:"active"===e.status?"Activo":"Inactivo"})}],F=[{label:"Editar",onClick:e=>{N(e),w(!0)},variant:"default"},{label:"Ver Empleos",onClick:e=>{window.open("/admin/json-crud/careers/jobs?department=".concat(e.slug),"_blank")},variant:"outline"},{label:e=>"active"===e.status?"Desactivar":"Activar",onClick:async e=>{try{await i.Ay.put("/api/admin/careers/departments/".concat(e.id),{...e,status:"active"===e.status?"inactive":"active"}),await P()}catch(e){f(e instanceof Error?e.message:"Error al actualizar")}},variant:"outline"},{label:"Eliminar",onClick:async e=>{if(confirm("\xbfEst\xe1s seguro de que quieres eliminar este departamento?"))try{await i.Ay.delete("/api/admin/careers/departments/".concat(e.id)),await P()}catch(e){f(e instanceof Error?e.message:"Error al eliminar")}},variant:"destructive",confirmMessage:"\xbfEst\xe1s seguro de que quieres eliminar este departamento? Esta acci\xf3n no se puede deshacer."}],I=[{key:"status",label:"Estado",options:[{value:"all",label:"Todos"},{value:"active",label:"Activos"},{value:"inactive",label:"Inactivos"}],value:A,onChange:q},{key:"location",label:"Ubicaci\xf3n",options:[{value:"all",label:"Todas"},...[...new Set(e.map(e=>e.location))].map(e=>({value:e,label:e}))],value:C,onChange:T}],O=async e=>{try{let a={name:e.name,slug:e.slug,description:e.description,head:e.head,head_email:e.head_email,head_avatar:e.head_avatar||"",location:e.location,team_size:parseInt(e.team_size),open_positions:parseInt(e.open_positions),status:e.status,budget:{annual:parseFloat(e["budget.annual"]),allocated:parseFloat(e["budget.allocated"]),remaining:parseFloat(e["budget.annual"])-parseFloat(e["budget.allocated"])},metadata:{founded_date:(null==j?void 0:j.metadata.founded_date)||new Date().toISOString(),total_hires:(null==j?void 0:j.metadata.total_hires)||0,avg_salary:parseFloat(e["metadata.avg_salary"]),employee_satisfaction:parseInt(e["metadata.employee_satisfaction"]),turnover_rate:parseFloat(e["metadata.turnover_rate"])},skills_required:e.skills_required||[],benefits:e.benefits||[],working_model:e.working_model},t=j?"/api/admin/careers/departments/".concat(j.id):"/api/admin/careers/departments",r=j?"PUT":"POST",s=await fetch(t,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!s.ok){let e=await s.json();throw Error(e.error||"Error al guardar departamento")}w(!1),N(null),await P(),f(null)}catch(e){f(e instanceof Error?e.message:"Error al guardar")}};return t?(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),(0,r.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})}):(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[b&&(0,r.jsx)(c.Fc,{variant:"destructive",children:(0,r.jsx)(c.TN,{children:b})}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(m.A,{className:"h-6 w-6 text-purple-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Gesti\xf3n de Departamentos"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Administra los departamentos de la empresa"})]})]}),(0,r.jsxs)(o.$,{onClick:()=>{N(null),w(!0)},className:"flex items-center gap-2",children:[(0,r.jsx)(p.A,{className:"h-4 w-4"}),"Nuevo Departamento"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(m.A,{className:"h-5 w-5 text-purple-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-purple-800",children:"Total Departamentos"})]}),(0,r.jsx)("div",{className:"text-2xl font-bold text-purple-900",children:e.length})]}),(0,r.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(h.A,{className:"h-5 w-5 text-blue-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-blue-800",children:"Total Empleados"})]}),(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-900",children:e.reduce((e,a)=>e+a.team_size,0)})]}),(0,r.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(g.A,{className:"h-5 w-5 text-green-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-green-800",children:"Vacantes Abiertas"})]}),(0,r.jsx)("div",{className:"text-2xl font-bold text-green-900",children:e.reduce((e,a)=>e+a.open_positions,0)})]}),(0,r.jsxs)("div",{className:"bg-orange-50 p-4 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(x.A,{className:"h-5 w-5 text-orange-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-orange-800",children:"Satisfacci\xf3n Promedio"})]}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-orange-900",children:[e.length>0?Math.round(e.reduce((e,a)=>e+a.metadata.employee_satisfaction,0)/e.length):0,"%"]})]})]}),(0,r.jsx)(l.A,{data:z,columns:L,actions:F,searchable:!0,searchTerm:E,onSearchChange:S,filters:I,pagination:{current:_,total:Math.ceil(D.length/10),pageSize:10},onPageChange:k}),(0,r.jsx)(d.lG,{open:y,onOpenChange:w,children:(0,r.jsxs)(d.Cf,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)(d.c7,{children:(0,r.jsx)(d.L3,{children:j?"Editar Departamento":"Nuevo Departamento"})}),(0,r.jsx)(n.A,{fields:[{key:"name",label:"Nombre del Departamento",type:"text",required:!0,validation:{min:2,max:100}},{key:"slug",label:"Slug (URL)",type:"text",required:!0,placeholder:"ingenieria-infraestructura",validation:{pattern:"^[a-z0-9-]+$",custom:e=>/^[a-z0-9-]+$/.test(e)?null:"El slug solo puede contener letras min\xfasculas, n\xfameros y guiones"}},{key:"description",label:"Descripci\xf3n",type:"textarea",required:!0,validation:{max:500}},{key:"location",label:"Ubicaci\xf3n",type:"text",required:!0,placeholder:"Lima, Per\xfa"},{key:"working_model",label:"Modalidad de Trabajo",type:"select",required:!0,options:[{value:"onsite",label:"Presencial"},{value:"hybrid",label:"H\xedbrido"},{value:"remote",label:"Remoto"}]},{key:"head",label:"Jefe de \xc1rea",type:"text",required:!0,group:"Liderazgo"},{key:"head_email",label:"Email del Jefe",type:"email",required:!0,group:"Liderazgo"},{key:"head_avatar",label:"Avatar del Jefe (URL)",type:"url",group:"Liderazgo",placeholder:"https://ejemplo.com/avatar.jpg"},{key:"team_size",label:"Tama\xf1o del Equipo",type:"number",required:!0,validation:{min:1,max:1e3},group:"Equipo"},{key:"open_positions",label:"Posiciones Abiertas",type:"number",required:!0,validation:{min:0,max:100},group:"Equipo"},{key:"budget.annual",label:"Presupuesto Anual (USD)",type:"number",required:!0,validation:{min:0},group:"Presupuesto"},{key:"budget.allocated",label:"Presupuesto Asignado (USD)",type:"number",required:!0,validation:{min:0},group:"Presupuesto"},{key:"metadata.avg_salary",label:"Salario Promedio (USD)",type:"number",required:!0,validation:{min:0},group:"M\xe9tricas"},{key:"metadata.employee_satisfaction",label:"Satisfacci\xf3n de Empleados (%)",type:"number",required:!0,validation:{min:0,max:100},group:"M\xe9tricas"},{key:"metadata.turnover_rate",label:"Tasa de Rotaci\xf3n (%)",type:"number",required:!0,validation:{min:0,max:100},group:"M\xe9tricas"},{key:"skills_required",label:"Habilidades Requeridas",type:"tags",required:!0,placeholder:"Escriba habilidades y presione Enter"},{key:"benefits",label:"Beneficios del Departamento",type:"tags",placeholder:"Escriba beneficios y presione Enter"},{key:"status",label:"Estado",type:"select",required:!0,options:[{value:"active",label:"Activo"},{value:"inactive",label:"Inactivo"}]}],initialValues:(e=>e?{name:e.name,slug:e.slug,description:e.description,head:e.head,head_email:e.head_email,head_avatar:e.head_avatar,location:e.location,team_size:e.team_size,open_positions:e.open_positions,"budget.annual":e.budget.annual,"budget.allocated":e.budget.allocated,"metadata.avg_salary":e.metadata.avg_salary,"metadata.employee_satisfaction":e.metadata.employee_satisfaction,"metadata.turnover_rate":e.metadata.turnover_rate,skills_required:e.skills_required,benefits:e.benefits,working_model:e.working_model,status:e.status}:{})(j),onSubmit:O,onCancel:()=>{w(!1),N(null)},submitLabel:j?"Actualizar Departamento":"Crear Departamento"})]})})]})}},90697:(e,a,t)=>{"use strict";async function r(e,a){let t=e.headers.get("content-type");if(!t||!t.includes("application/json")){if(!await e.text())return null;throw Error("Expected JSON response, got: ".concat(t))}try{let a=await e.text();if(!a.trim())return null;return JSON.parse(a)}catch(e){throw Error("Invalid JSON response from ".concat(a,": ").concat(e instanceof Error?e.message:"Unknown JSON parse error"))}}async function s(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=function(){let e=localStorage.getItem("auth-token"),a={"Content-Type":"application/json"};return e&&(a.Authorization="Bearer ".concat(e)),a}();return fetch(e,{...a,headers:{...t,...a.headers||{}}})}t.d(a,{Ay:()=>i});let i={get:async function(e){try{let a=await s(e);if(!a.ok){let e=await a.text();throw Error("API Error (".concat(a.status,"): ").concat(e))}return await r(a,e)}catch(a){if(a instanceof TypeError&&a.message.includes("fetch"))throw Error("Network error: Failed to fetch from ".concat(e,". Check your internet connection."));throw a}},post:async function(e,a){try{let t=await s(e,{method:"POST",body:JSON.stringify(a)});if(!t.ok){let e=await t.text();throw Error("API Error (".concat(t.status,"): ").concat(e))}return await r(t,e)}catch(a){if(a instanceof TypeError&&a.message.includes("fetch"))throw Error("Network error: Failed to post to ".concat(e,". Check your internet connection."));throw a}},put:async function(e,a){try{let t=await s(e,{method:"PUT",body:JSON.stringify(a)});if(!t.ok){let e=await t.text();throw Error("API Error (".concat(t.status,"): ").concat(e))}return await r(t,e)}catch(a){if(a instanceof TypeError&&a.message.includes("fetch"))throw Error("Network error: Failed to update ".concat(e,". Check your internet connection."));throw a}},delete:async function(e){try{let a=await s(e,{method:"DELETE"});if(!a.ok){let e=await a.text();throw Error("API Error (".concat(a.status,"): ").concat(e))}if(204===a.status)return null;return await r(a,e)}catch(a){if(a instanceof TypeError&&a.message.includes("fetch"))throw Error("Network error: Failed to delete from ".concat(e,". Check your internet connection."));throw a}},fetch:s}}},e=>{var a=a=>e(e.s=a);e.O(0,[4277,2536,9550,7328,8965,4198,9658,1781,7615,2192,8441,1684,7358],()=>a(43453)),_N_E=e.O()}]);